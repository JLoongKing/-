-- phpMyAdmin SQL Dump
-- version 4.7.6
-- https://www.phpmyadmin.net/
--
-- Host: localhost
-- Generation Time: 2018-07-04 05:11:52
-- 服务器版本： 10.1.29-MariaDB
-- PHP Version: 7.2.0

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET AUTOCOMMIT = 0;
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `db_blog3`
--

-- --------------------------------------------------------

--
-- 表的结构 `t_banner`
--

CREATE TABLE `t_banner` (
  `id` int(11) NOT NULL COMMENT 'bannerId',
  `imgurl` varchar(100) NOT NULL COMMENT '图片地址'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `t_banner`
--

INSERT INTO `t_banner` (`id`, `imgurl`) VALUES
(1, '/tp50/public/Uploads/20180704/5b3c25bc3f9c9.jpg'),
(2, '/tp50/public/Uploads/20180704/5b3c25c267cb6.jpg'),
(3, '/tp50/public/Uploads/20180704/5b3c25c667d71.jpg'),
(4, '/tp50/public/Uploads/20180704/5b3c27e8e705e.jpg');

-- --------------------------------------------------------

--
-- 表的结构 `t_blog`
--

CREATE TABLE `t_blog` (
  `id` int(11) NOT NULL COMMENT '博客id',
  `title` varchar(200) DEFAULT NULL COMMENT '博客标题',
  `summary` varchar(400) DEFAULT NULL COMMENT '博客简介',
  `clickHit` int(11) DEFAULT NULL COMMENT '点击数',
  `replyHit` int(11) DEFAULT NULL COMMENT '评论数',
  `content` text COMMENT '内容',
  `typeId` int(11) DEFAULT NULL COMMENT '类别d',
  `keyWord` varchar(200) DEFAULT NULL COMMENT '关键字',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `t_blog`
--

INSERT INTO `t_blog` (`id`, `title`, `summary`, `clickHit`, `replyHit`, `content`, `typeId`, `keyWord`, `create_time`, `update_time`) VALUES
(72, '第一章  初入 ', '    西牛贺洲地域之大，南北东西各有万里之遥，百里之地即可称邦号国，大小城邦不计其数。乌鸡国地处西南一隅，方圆十多万平方公里，相比那东土神国，就连一州之地都相差甚远。但是在西域之地，却也是极为强大的国邦。周围小国年年进贡，岁岁来朝。乌鸡国祖先连年征战打下一片疆土，之后十几界国王倒也算得上贤明有德。当今圣上轻', 2, 0, '<p>&nbsp; &nbsp; 西牛贺洲地域之大，南北东西各有万里之遥，百里之地即可称邦号国，大小城邦不计其数。乌鸡国地处西南一隅，方圆十多万平方公里，相比那东土神国，就连一州之地都相差甚远。但是在西域之地，却也是极为强大的国邦。周围小国年年进贡，岁岁来朝。乌鸡国祖先连年征战打下一片疆土，之后十几界国王倒也算得上贤明有德。当今圣上轻摇赋税，臣子治民有方，百姓安居乐业，时值春社已近，百姓们都放下手中的活，享受难得的休息。</p><p>城中大小商铺林立，热闹非凡，一家酒馆看似不大，但里面确是极为吵杂，宾客与小二来往不断，人们的吵闹声音不绝于耳。</p><p>“今年的天气有点特殊不知道你们看出来了吗，我总觉得这不是一件好事情”一位看上去文质彬彬的读书人为自己斟了一小杯酒，小小的抿了一口对着大家说道。</p><p>他一双眼睛瞄了瞄同一桌上的其他人，见都被他的话吸引，一言不发，等着他的下文，他心里很满意，就晃了晃酒杯，想了想继续说道：“我们乌鸡国本就地处南方，春夏秋冬固然分的仔细不过，但是由于我们地处南方，相对的也就一年四季比北方要暖和一些，但是今年却不知怎么回事，却是格外的寒冷”</p><p>&nbsp; &nbsp;“听你这么一说好像确实是这样呢”</p><p>“嗯，今年天气实在怪异，冷的出奇却没下过一场雪！”</p><p>“我听我爷爷说乌鸡国已经有近60年没有这种天气了”</p><p><span style=\"white-space:pre\">	</span>“哎，你们听说了吗，听说今年皇宫里不太平”一个满脸奸猾之象的年轻人喝了一口酒乍了乍舌接着说道，“你们说今年天气和这有关系吗？”。</p><p><span style=\"white-space:pre\">	</span>“哦，怎么不太平？”众人被勾起了好奇心。</p><p>他又抿了一口酒，慢慢的吧唧吧唧嘴“好酒”。</p><p>“你小子别光喝酒，倒是说啊”</p><p><span style=\"white-space:pre\">	</span>“嘿嘿，别急嘛！就是我有一个亲戚在宫里当差，他说他看到过御花园里的一口八宝琉璃井在夜里发光。你们说是不是有鬼魂作祟。”</p><p><span style=\"white-space:pre\">	</span>“其实你这也并不稀奇，皇宫吗？ 很容易有这种情况的，说不定就是哪个宫女投井后的鬼魂呢”大伙猜测说。</p><p><span style=\"white-space:pre\">	</span>“对对，含冤而死导致天象有异有可能！”有人和之前的事情联系了起来，众人纷纷点头。</p><p>“别瞎说，哪个鬼魂能有这个本事，还改变天象！，更何况当今皇上还是挺圣明的，大家伙啊莫谈国事”掌柜子插嘴道“今天天气冷，给几位也多加了个煮豆腐，来，都尝尝！”</p><p>“对对，莫谈国事！嘿嘿！”众人笑道。</p><p>&nbsp;乌鸡国王宫处于整个乌鸡国城邦的中心位置，皇宫修在了一条活水的两边，建筑阁楼气势磅礴，虽然已经过了不知多少年的沉淀，但是却还有这那种朝气蓬勃之感。</p><p>乌鸡国传承至今已过十余代，经过积累，已将王宫修建的美轮美奂，御花园中有一口八角琉璃井，此时那井中井水翻腾不止，在其中现一龙形，这龙苍如劲松，身下云气翻涌，如若将入长空，又似急渊入海，这龙似云气缩聚，又有钟灵之气缠绕而上，龙形的身体俞稳，云气缓缓消失不见，只见那龙摇身一晃变作一青年，那青年相貌不凡，头戴金冠，身着紫色的锦袍绣衣，腰间有一金线织成的明黄金丝带，足踏青云疾风履，有一种独有的气质萦绕其身。青年眼睛缓缓睁开，眼中有所明悟。</p><p>正是大地初开，阴阳交互，形成了天地之间的第一缕和泰之气，又有成百上千年的积累，得大地钟灵汇集逐渐而成，今日方得孕育而出，出生即可翻云覆雨，当是金仙之境。</p><p><span style=\"white-space:pre\">	</span>青年长身而起“以后我就叫季逸云吧！前尘以往皆为灰烬。”前尘如梦，其实季逸云也分不清到底是什么前世生活到底是真实还是一场梦。上一秒钟还在电脑旁，这一秒就来到了这个世界。想到井龙王在西游世界里简直就是一个打酱油的存在，季逸云不由得苦笑，井龙王其实根骨奇高，想那猴子他就是一颗石头经过天地精气雕琢就能有那样的成就，而井龙王可是天地初开的第一缕和泰之气而成，未来成就不可限量，说起来他和天生地长的都算是兄弟姐妹呢，季逸云的苦笑不由得又加重了一些。不过呢当前的任务是变强，这一点季逸云还是知道的，他可不想在默默无闻一辈子，想了想，季逸云消失在原地。</p><p>季逸云来到了乌鸡国城中的闹市，他是金仙境界，想来闯荡江湖不成问题。他走在热闹的大街上，乌鸡国不愧为强盛的城邦，大街上人来人往，摩肩接踵，异常的热闹突然看到一家酒馆，酒馆并没什么不同但是它的牌子很新奇上面就有一个字“御”，但是旁边立了一个木桩挂着一面旗帜，上书“云海翻滚处，机缘莫强求”。</p><p>&nbsp; &nbsp; 怪人怪事还真是多，季逸云略微诧异，但也没多想摇了摇头就想继续走了解一下这西游世界的风土人情。</p><p>&nbsp; &nbsp; “嗨，兄弟，你是在想招牌的事吗”这时一个满面通红的少年走了上来，一看就是喝多了那种，一步一个踉跄，上来勾住季逸云的肩膀就问道，季逸云眉头略微一皱。&nbsp;</p><p>&nbsp; &nbsp; “对啊！”季逸云下意识答到。</p><p>&nbsp; &nbsp; “想知道吗？想知道的话。。。。”&nbsp;</p><p>&nbsp; &nbsp; 他的眼神向里面瞟了瞟，样子一下变得好贱，满脸奸笑道“嗯。。嗯。。，有点渴了”。</p><p>&nbsp; &nbsp; 季逸云顿时明白了，想喝酒了啊，心中好笑。</p><p>&nbsp; &nbsp; “哦。。哦，兄弟，里面请！走咱们喝两杯。”季逸云推开他的胳膊当先向里面走去。</p><p>&nbsp; &nbsp; 酒馆里面倒也和平常没什么两样，就是简朴的有些过头了，除了桌椅再无它物，虽然有一种很古老的感觉，但偏偏一眼看去都是新的，“难道乌鸡国还流行古典美。。。”季逸云心中有种很古怪的感觉。进到里边，找了个贴着窗户的座位坐下了。</p><p>&nbsp; &nbsp; “小二，来几斤上好的女儿红”少年当先叫道。</p><p>&nbsp; &nbsp; “客官，几斤啊”小二笑道。</p><p>&nbsp; &nbsp; “你说呢，就是老规矩”少年反应过来斜了个白眼。</p><p>&nbsp; &nbsp; “嘿嘿，明白！乙二桌两斤女儿红！”季逸云心想“得，这家伙还是常客，果然被坑了！”</p><p>&nbsp; &nbsp; “兄台怎么称呼？”</p><p>&nbsp; &nbsp; “在下季逸云，你唤我季兄或者云哥儿都行”季逸云客气到。</p><p>&nbsp; &nbsp; “在下欧阳，姓欧，名阳，非是复姓欧阳”。</p><p>&nbsp; &nbsp; “哦哦，欧兄”季逸云很想翻一个白眼，这个家伙到底被误会了多少次，这么深刻，还非得解释一下。</p><p>&nbsp; &nbsp; &nbsp;欧阳不好意思的笑了笑就继续往下说“要说这酒楼为何有个‘御’字匾这可说来话长了，兄台你不是本地人吧，本地人都知道这个的匾来历”他也没停顿露出一副你肯定不是本地人的架势道“话说很久很久很久。。。以前”见他还要“很久”下去，季逸云瞪了一眼“说重点”。这时酒端了上来“客官，慢用！”。</p><p>&nbsp; &nbsp; “额，大概200多年前这里就已经是乌鸡城中比较有名的酒馆了，三教九流就没有没来过的，本来再长的就干也没有道理长时间红火下去，由于当时经济灾荒的关系酒馆里人越来越少，这东西就这样太平年岁百姓家里有的是闲钱，每天都有人花钱找乐子，但到了当时几乎吃饱饭都是个问题，你说谁能来这酒馆啊！”，季逸云听到这里点了点头道“也是，宁为太平狗，不做乱世人！”。</p><p>“兄台，你这句话精辟啊！当时几乎没几个人去酒馆，但是有一天来了一位老道士。这老道士可是一位了不得的人物！”说到这里欧阳停了停，喝了口酒喳了喳。</p><p>“哦，怎么了不得？”季逸云被勾起了兴趣。</p><p>“他是一位神仙。”</p><p>“哦，怎么个神仙法？”随即又暗想道“我还是一位神仙呢！”。</p><p>“他来时和普通的游方道士没什么两样，风尘仆仆，听说道袍上还缝着几个补丁。当时老板和老板娘是一对老夫妻人也很善良，生意不好做，但是靠着百年老店的招牌还不至于开不下去，他们看到老道人单衣薄再加上拿不出饭钱，就发了善心免了道人的饭钱。这老道临走之前就留下了一句话和一块匾，然后他又对那老夫妻说’你们积德行善百年后该当升仙得道。‘ ，而那块匾就是‘御’字匾，那话就是外面旗帜上那句话。那对夫妻果然长寿百岁，去时有白鹤接迎，而那匾挂到如今依然光亮如新，人多说‘御’字中是有机缘的。”</p><p><br/></p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp;</p>', 13, '', NULL, '2018-06-07 09:32:11'),
(73, '第二章  天外符诏', '季逸云倒是对那块匾有了兴趣。“掌柜子，能否借你家的匾一看？”“年轻人，你不要听欧阳这小子的忽悠。他都不知道和多少个外乡人说过这话了”掌柜子离老远就对着季逸云苦笑道。“你小子又在骗人！外乡人，别信他的话，这御字匾我家传了这么多年也没看出有什么不一样。”掌柜走过来斜瞪了一眼欧阳说道。“明叔，你这就不对了，我可是从', 1, 0, '<p>季逸云倒是对那块匾有了兴趣。</p><p>“掌柜子，能否借你家的匾一看？”</p><p>“年轻人，你不要听欧阳这小子的忽悠。他都不知道和多少个外乡人说过这话了”掌柜子离老远就对着季逸云苦笑道。</p><p>“你小子又在骗人！外乡人，别信他的话，这御字匾我家传了这么多年也没看出有什么不一样。”掌柜走过来斜瞪了一眼欧阳说道。</p><p>“明叔，你这就不对了，我可是从小就听这个故事长大的，你说这城里哪家不知道你家这块匾的故事，这是肯定是真的。”欧阳明显已经喝的神魂颠倒了，他鼓着腮帮子，咧着嘴反驳掌柜子。</p><p>“你小子净瞎想，故事读多了吧，天天忽悠外来人！你都多大了，还天天来这里喝酒不去找点活干”掌柜子恨铁不成钢的骂道。</p><p>“好了，好了，明叔，我母亲托人给我找了个帮工的活过完年就去，你天天墨迹起来没完烦不烦啊”欧阳撇了撇嘴道。</p><p>“哼，你这小子，这才对嘛”掌柜子笑了笑。</p><p>季逸云能看得出掌柜子对欧阳还是极好的。抗不过过季逸云的坚持，掌柜子只好陪着他两个来到店前，季逸云望向那块匾，只觉得当中那个御字越看越有其中独特的滋味，越看越有种陷进去的感觉，季逸云挣扎要逃脱出这种感觉，可是却愈发的陷入其中,季逸云只觉得御字越来越大，感觉要将自己的神精压碎。他突然感觉精神一松，眼前只剩下碧海青天，海上有一岛。</p><p>这岛气势磅礴，碧海本来一望无际，但是这岛在海上一横，居然有一种隔绝天地之感，岛上生机盎然，无数飞禽走兽仙气弥漫。岛的东边是山岭绝壁，将岛中陆地与一望无际的海水隔绝，海水拍打着绝岭峭壁，啪啪作响，那些绝壁也不知形成了多少年，让人一看，有一种惊险之感，但却又觉得出奇的可靠。岛的西边却是银色的沙滩，沙滩一望无际，碧海沙滩形成一线天地一般，海浪一层层的拍打着沙滩，银色浪花和白色的沙滩一圈圈变化，由远及近由高变低，竟有一种博大磅礴之感。远观苍山连绵起伏，地脉走势由高变低，山上四季常青，外界根本看不到的奇珍异兽无数。</p><p>画面一转，已经置身与岛前，岛前有一石碑，碑上有文” 金鳌岛“，再向前，有金龟仙鹿，白鹤银花，岛最中间有一宫殿，上书” 碧游宫“，这碧游宫好似在天外，隐隐不显，宫中有弟子正在静颂黄庭，一排仙家气象，原来是通天教主的地盘。</p><p>季逸云感官一转眼前只剩下一符诏。季逸云有所明悟，原来是截教的“招生通知单”，这截教是要广播种，优选粮啊，倒是挺有先进思想，还来个学院介绍。不过总比其他大能根本见不到好。走一步看一步吧，不如先去东土看看，也不知是哪朝当政。</p><p>“客官。。。”</p><p>“哦！怎么了？”</p><p>“可有发现。”</p><p>“没有，我在想一些事。”</p><p>“我就说没有吧，你还不信。”</p><p>………………………………………….</p><p>几天后，野外荒山，一名青年边走边擦着汗，“这黑山村到底在哪啊！渴死我了！”这名青年青衣纶巾，穿着一双草鞋，背着竹篓。一看好似进京赶考的读书人。他向前面望了望，发现不远处有一青年，那青年穿着一身白衣白袍，头发并没有扎起来而是披头散在身后，身无一物，背向他缓步的往前走去，正是季逸云。</p><p>“前面那个兄台，等等我！”青年大声喊道。季逸云转过头，看了看那青年，站在原地等着他过来，青年快走了两步赶了上来。季逸云向他笑了笑“兄台，何事！”。</p><p>“我想问一下，黑山村怎么走？”那青年紧赶慢赶才跟了上来，他好不容易喘了口气，低头擦了擦汗，对着季逸云笑着问道道。</p><p>“我也是远方来客并不知兄台你说的黑山村。不过没什么事就和你一道如何，也是个伴？”季逸云也正好向东，就想到和他一起走一段路，顺便了解一下这个地方的人文环境</p><p>“好啊，我也正愁路上没有个说话的，兄台，你叫什么名字，在下宁采臣。”宁采臣憨笑道。</p><p>“我啊，我叫季逸云，你叫我季兄即可”季逸云下意识的回答道，旋即惊讶道：“什么，你是宁采臣？”，没想到他就是宁采臣，也没啥特别的吗？</p><p>“季兄，你认识我？”宁采臣惊讶道。</p><p>“哦，没有就是觉得你的名字似乎在哪见过。”季逸云略显尴尬。</p><p>“哦，原来是这样，季兄为何经过这里啊？”宁采臣也没多想，旋即问道。</p><p>“游历而已，正好路过，你呢？”</p><p>“我是官府派来的井匠，这里已经旱好多年了，县老爷我来找水源”宁采臣略显羞涩。</p><p>“咦，前面有口井，我们去看看。”他说着见到了前年有一口井，就招呼季逸云一起过去。</p><p>季逸云走近一看，这哪里叫井，简直就是一脏水坑，里面的水也没有多少，宁采臣把水打上来，喝了一口，递给季逸云。</p><p>季逸云哪里敢喝，连忙摇头，这时从旁边冲出一片人，一下将宁采臣捆住，那帮人见季逸云颇有气势也没敢乱来。”他可是官府的人，你们敢抓他，你们就不怕吗？“季逸云对那群人说道。</p><p>“什么，他是官府的人，我们闯祸了。”</p><p>“赶紧去叫村长。”</p><p>“哦”</p><p>那群人乱成一团，你一句我一句，有点不知所措，不一会有个老头缓步走来“不知二位贵客驾到，有失远迎，请恕罪！可否将官书文凭给我看看”</p><p>宁采臣让季逸云帮他将腰牌拿了出来“给！”。</p><p>那老头接过去看了看急忙点头哈腰道“原来是官府的大人，还楞着干嘛，赶紧给大人松绑。”那帮人又七手八脚的将宁采臣松了。</p><p>众人将两人迎进了村又设宴款待他们，宁采臣这才明白，原来他们靠着弄一些土罐挣钱，可是这几年连年干旱没有水，土罐也烧不成了，这才请官府的人过来帮忙。</p><p>众人将宁采臣当祖宗一样供着，难免有些冷清了季逸云，季逸云倒也乐得清闲，其实他毕竟是龙王倒也懂一些行雨神通，可他能看出来那些村民身上有轻微的妖气，所以明白一定不是简单干旱，肯定另有隐情。一定要调查清楚再说，不能莽撞行事，季逸云心中盘算。</p><p>晚上，两人被安排在了同一间房。</p><p>“云哥，你明天陪我去山上找水源可以吗”经过半日相处，两人关系近了许多。</p><p>“可以啊，正好我也无事，玩玩也好”季逸云正想找一个机会跟上呢。</p><p>。。。。。。。。。。。。。。。。。。</p><p>第二天一大早季逸云就被宁采臣叫醒，一行人吃过早饭就出发了。</p><p>村子的西北角就是上山的道路，这座山虽然不高，但有一种稳如泰山之感，压抑在众人心底，众人在不知不觉中打了个寒颤。</p><p>“龅牙哥，你为什么将他们用链子拴住啊？”宁采臣很奇怪的向村中向导问道，不知为何和他们上来的是几个人都是被铁链拴在一起的</p><p>“大人，他们都是死刑犯啊，村长是要他们将功赎罪的。”向导是一个龅牙说话漏风，而且一紧张就磕巴。</p><p>“我们要是不是死刑犯，谁能和你上山啊！”旁边几人嚷嚷道，随即有大笑起来，不过，感觉好凄凉。</p><p>“山上有古怪！”宁采臣和季逸云心中同时升起一个想法。</p><p>“大人，这条道我小时候和我父亲不知走了多少遍，我熟。”大龅牙好似不想再继续讲下去。</p><p>大家都不再说话，气氛有些沉重，这时，前面有一棵树，树冠大的吓人。</p><p>“大家歇会吧！这颗树正好乘凉。”宁采臣有些累了。</p><p>“宁兄，我看这天要下雨，我们还是躲躲吧！”季逸云看着阴下来的天道。</p><p>“大人，前面有一个庙，我们去那避避如何？”龅牙想到了一个躲雨的好去处。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>', 13, '', NULL, '2018-06-07 09:32:02'),
(74, '第三章  小倩？小青！！ ', '荒山野岭，哪来的庙，怕是妖魔作怪，降妖除魔是我等正道少侠职责，计逸云心里暗自寻思。宁采臣倒没什么想法，他只要找得到避雨的地方就行。大家一致同意，一起来到庙前。庙一看就已经是是一座老庙，庙虽老但是好像有人常常加以打扫，竟然一尘不染，中间有无数烛火通明。庙里给人宁静祥和之感，竟然没有一丝妖气，季逸云心中有点迷惑。', 2, 0, '<p>荒山野岭，哪来的庙，怕是妖魔作怪，降妖除魔是我等正道少侠职责，计逸云心里暗自寻思。宁采臣倒没什么想法，他只要找得到避雨的地方就行。大家一致同意，一起来到庙前。庙一看就已经是是一座老庙，庙虽老但是好像有人常常加以打扫，竟然一尘不染，中间有无数烛火通明。庙里给人宁静祥和之感，竟然没有一丝妖气，季逸云心中有点迷惑。他能看出来，这庙经过神通加持，但力量竟然集中在了一点，气息慢慢流淌最终都流向了庙的中心，如同会呼吸一样。</p><p>“这座庙在我小时就是这样，庙祝是个怪人，偶尔云游回来将这里打扫一下，然后就又不知去哪里云游了，和他对话他也不搭理。奇怪的是，他打扫还是不打扫，感觉这里也没什么变化，都是那么干净整洁。”大龅牙对众人讲道。</p><p>季逸云当先走进其中，他一进入庙中就有一种温暖舒适之感，并没有想象中那样群魔乱舞。众人席地而坐想休息片刻，季逸云恍恍惚惚觉得自己来到了另一个地方。他猛地一惊，竟然这么轻易就被蒙蔽了精神。他抬头一看，觉得这个地方有点熟悉，仔细辨别了一下，原来是碧游宫，只不过上回是浏览环顾了一遍，而今天可以仔细观看。宫阙万千，仙禽神兽不计其数，圣人居所，紫气千里，虽无笙萧鼓乐，却有大道之音。</p><p>“师兄，有祖师法旨！”一枚小萝莉出现在季逸云身前，萝莉扎着两个馒头包，一身朴素道袍，一脸严肃的样子，季逸云一看非但没体会到严肃反倒被萌翻了。</p><p>“弟子季逸云接法旨！第一届普通弟子季逸云基础考核触发开始，</p><p>故事背景：有法师见黑山有宝，建寺，曰“黑山”，百年前蜀山镇妖于其地，现有劫现，遣弟子季逸云历劫。</p><p>要求：助正道灭妖，得黑山之宝人族祭祀香火之精。</p><p>成功：奖黄庭心经，赐截教弟子令牌。</p><p>失败：扣除成为截教弟子资格。”</p><p>小萝莉用手一指，手中法旨化光束进入了季逸云脑海。“师兄，祖师让我告诉你他很看好你，还说你的跟脚特别的优异，希望你不要浪费了这么好的资质。”小萝莉眨着大眼睛对季逸云说，你这么萌你家人知道吗？季逸云心中吐槽道。</p><p>“那你告诉师兄，什么叫做第一届普通弟子啊！”季逸云忍不住的弄了弄小萝莉的两个冲天辫，弄得小萝莉轻轻地晃了晃。</p><p>“哦，这是祖师最近研究出来的的一个新型教化程序，用来选优异的亲传弟子，而师兄你是第一届体验学员，由于那件事的失败，祖师觉得以前的弟子选拔太过随意，所以新研究了一个这个系统。”“那件事，一定是封神了！”季逸云暗中想到。“师兄，时间不早了，快回去吧！一边说着一边重重的推了季逸云一下。</p><p>季逸云猛的惊醒，发现已经在黑山庙中，众人都还在休息，季逸云整理了一下思路，没想到黑山庙下竟然还有重宝。说不得必须参与到这件事中，仔细想一下主角有三个，宁采臣和小倩，中间有个燕赤侠。小倩是一只在里面就是一只小妖，宁采臣就更不用说了，就是一个凡人，不过感觉他们好像挺有故事的，说不定上一世就是夫妻，不过这和这次事并不发生关系，小倩可以策反，宁采臣必须重点保护，燕赤侠是主要战力，这次少不了他的出力，想到这里，季同学又想到了小萝莉的一席话，祖师都能记住自己的名字，说明本少侠也是一个很厉害的人吗！嗯，我也是主力，帮助三大主角对战老妖，说不定我也可能流传千古，嘿嘿，故事就叫计少侠大战榕姥姥！小季同志YY道。</p><p>“云哥，你傻笑什么呢”宁采臣不知道什么时候醒了，看到季逸云傻笑着不禁出声问道。季逸云连忙摆好坐姿。他突然想到了些什么，连忙问道“宁兄家中可还有什么人？”宁采臣也很健谈，见季逸云问起，他倒是不含糊，把家中的七大姑八大姨都聊了出来，季逸云听完明白了家中亲戚虽多，但都是较远的关系，只有家母在堂，尚未婚取。倒是和小倩般配，如果可能，定要成全了他们。季逸云突然觉得阴风阵起，有妖气逼近，他借口出去走走就出了庙门。</p><p>出门寻一处众人看不到的地方，感觉到那妖风跟了过来，季逸云本身境界并不高，但无奈龙身对其他妖怪有一种天生克制，他虽不是正统龙身，但却比正统还要高贵，他艺高人胆大，并不惧怕这些妖怪，“既然来了就别躲躲藏藏了”季逸云将高人风范装的淋漓尽致，头也没回，长发无风自动，再加上风骚的衣着还真有一种大神风范。</p><p>那女妖可不管这些，风铃声响起，摄人心魄，意志不坚者如若听闻此铃，便被摄了心魄，动弹不得，但季逸云出生便有神通，如何能被摄住，且不说女妖只是小妖，便是姥姥在此也不能轻易影响季逸云心神，女妖见季逸云站住不动，她以为季逸云心神以被影响想利用近身攻击终结此战，她快速靠向了季逸云身后亮出利爪，想要速战速决。季逸云本想利用龙神对妖怪的等级克制轻易取得胜利，但如今看来并不需要那么麻烦，他有本命神通御气之术，御气术是季逸云的本命神通，因他是云气风水得天地钟灵而成，所以对风云等操纵自如，御风而行速度极快的闪过了女妖的杀招，御气成龙瞬间将女妖缠住。女妖还没等反应过来已被季逸云轻易地控住。</p><p>“哎，何必呢，打不过我你就跑啊，非得刚正面。”季逸云轻轻摇了摇头。样子要多轻蔑有多轻蔑斜眼瞧了女妖一眼，说句实话，长的真心不赖，乌黑亮丽的长发柔顺地垂肩，水灵灵的大眼睛映着光芒卷翘的睫毛俏皮的颤动，就像一只可爱的蝴蝶。但漂亮的粉唇却向上撅着，一脸厌恶的样子。“你叫什么名字？”季逸云想确认一下是不是小倩。</p><p>“哼！”</p><p>“识时务者为俊杰，现在你为鱼肉，我为刀俎，看来你还是没看清情况啊！你不说我也知道，你名字叫聂小倩，现在在姥姥手下，今夜你要为姥姥搜集精血，对是不对！”季逸云不想和她废话了，赶紧策反了她。还有好多准备工作要做呢。</p><p>“人家好不容易修成元神，出来逛逛，就被你这大坏蛋抓了起来，谁认识那个什么姥姥啊，师父说得对，外面全是坏人”女妖精说着还哭了起来。</p><p>“你不叫小倩？”季逸云尝试着问了问。</p><p>“你才叫小倩呢！你全家都是小倩，你是不是文盲啊，本姑娘叫小青，不叫小倩”季逸云不说还好，一说就被那女妖精骂的个狗血淋头。</p><p>季逸云第一印象就是白蛇传中的小青 “这尼玛乱入啊！不科学啊！”</p><p>“我去，这也能抓错”季逸云气的骂娘。</p><p><br/></p>', 13, '', NULL, '2018-06-07 09:39:44'),
(75, '第四章  青山有幸 ', '虽然对于季逸云来说生活真的无奈，但既然没有办法反抗，那就只能享受，就像现在这样，虽然抓错了人，但是就当成社会对刚入此道的少侠的磨练吧。吾辈每当遇到困难，就应该迎难而上，磨刀霍霍。季逸云想到这里，他不由得嘿嘿一笑，计由心生。小青见他笑得颇为灿烂，还以为他想通了，哪里会知道季逸云现在一肚子坏水全是在想怎么弄她呢。', 3, 0, '<p>虽然对于季逸云来说生活真的无奈，但既然没有办法反抗，那就只能享受，就像现在这样，虽然抓错了人，但是就当成社会对刚入此道的少侠的磨练吧。吾辈每当遇到困难，就应该迎难而上，磨刀霍霍。季逸云想到这里，他不由得嘿嘿一笑，计由心生。</p><p>小青见他笑得颇为灿烂，还以为他想通了，哪里会知道季逸云现在一肚子坏水全是在想怎么弄她呢。她大声对季逸云道“喂，你是不是明白了，我和你说的小倩真的没有一点关系，你能不能先放了我。”</p><p>“咳咳，你这妖怪，除魔卫道乃我等武林少侠本分，今日既然见你就不能放过你，省的以后成长起来为祸一方。”季逸云把自己的脸色尽量装的凶狠。小青俏脸微白，心想“想不到刚出茅庐就遇到如此狠角色，后悔不该不听师父的话，自以为是，还以为凭自己的修为天下皆可去得。”</p><p>时值深秋，天气逐渐转凉，落叶随着秋风不断的飘零掉落发出“沙沙”的响声，日落西山，本来就有些昏暗的树林里如今更是阴森得有些可怖，这对两个人来说并不算什么。可是他们之间凝重的气氛非但没有消散，反倒越积越多，凝重如水。</p><p>“想活命也可以,除非你自己证明你不是小倩。”</p><p>小青本以为自己必死无疑，没料到还有一线生机松了口气，满口答应。</p><p>“你想让我怎么做？”她心想只要计逸云放了她，她就是“海阔凭鱼跃,天高任鸟飞。”到时想走就走，谁还拦着她，先答应下来，做不做还不是随本姑娘的意。</p><p>“你说像你这样乳臭未干的小丫头，也敢到处乱闯！”计逸云绕着小青转了几圈“这也就是我要是别人你估计就是求死不能了”</p><p>“哎，算了你走吧，接下来的事你干不了”计逸云把小青松开对着她摆了摆手，表情就好像在赶苍蝇一样。</p><p>“哼，有什么本姑娘干不了”话一出口小青就有点后悔，本来就想恢复自由就跑，这回人家放了自己，自己反倒还不走了，这不是犯贱吗。不过话已出口，覆水难收只能硬着头皮上了“你说吧！”</p><p>计逸云呵呵一笑，果然上当了，眼珠一转，决定演的逼真点，他摇身一动，身上的衣服就变成了一身道服，手里变出了一根拂尘，用另一只手捋了捋胡须“贫道终南山梅氏子，听闻这座山有一被封印的大妖，利用手下小妖吸食他人精气壮大自己以求能够早日挣脱封印，所以特来消灭此妖，如果你能帮助我消灭她，就能证明你是一个好妖，我就放过你。”</p><p>“这等妖怪人人得而诛之，有什么不能帮你的”小青黑白分明的眼睛眨了眨，偏头想了一会就答应了。</p><p>。。。。。。。。。。。。。。。。。。。</p><p>洪荒世界，山很高，占地面积也非常大，大黑山中心地带，树木茂盛，生灵葱郁，“前面应该就是姥姥封印之地了”计逸云向前面一个洞口指了指，他感觉到了妖气的源头就在那里。计逸云本来想先回寺庙与宁采臣会和，但后来又想既然有小青帮忙，就不应该让宁采臣一个凡人帮忙，万一出现什么问题就顾不了他了，岂不是白白葬送了他的性命，所以他和小青两个人来到了这里。</p><p>“接下来可能有危险，我们一定要万分小心，明白吗？”</p><p>“好了，你这么厉害还有什么好怕的”小青轻轻吐了吐舌头大大咧咧的说道。</p><p>计逸云赶忙呵斥道“你懂什么，人外有人天外有天，厉害的人多着呢！”</p><p>“行了行了，你咋和我师父一样啰嗦，不对是比他还啰嗦”小青一脸的不耐。</p><p>“那好！我们这就进去，进去后一定万事听我的安排，不要自作主张，明白吗“</p><p>”明白了，明白了“小青不耐烦地摆摆手。</p><p>两人来到洞口，洞口幽深宁静，竟让人见到有一种紧张之感，虽然两人都是天不怕地</p><p>的主，但是即使这样，小青也往计逸云身后躲了躲。</p><p>“是不是有点害怕了？“计逸云瞧了一眼小青问道，”怎么可能，本姑娘是何等人物？会被区区山洞吓住吗？“小青一边说着还一边挺了挺小胸膛，露出一副很不屑地表情。</p><p>“是吗？“计逸云似笑非笑的看了她一眼。随即便大步迈了进去。</p><p>“喂，等等我啊！”小青急忙跟上。</p><p>两人大概向里走了几十米，有光，两人进入，豁然开朗，有一个大型的广场，这是很令人惊讶的，谁能想到一座山中能有一个如此宽敞的大型广场，广场四周皆不知被何物所围，顶上有明珠巨万照亮其中，成大周天星斗之形摆列，广场上有泥塑，好似上古之民祭祀之象，可是不知为何广场最中间的高台上什么都没有，好像他们祭祀的东西根本不存在，但计逸云转念一想，不对，应该是被人取走了，因为台上的巫师右手拿着权杖正在指向左手捧着的盘子，盘中应该是有东西的。</p><p>祭祀的先民被刻画的非常逼真，包活大人们满脸严肃的表情和小孩子们嬉闹的场景，都表现得淋漓尽致，甚至就连巫师在祷告上天非常虔诚的表情都描绘的活灵活现，众人中间应该有一条道路，因为他们的刻意避开，那条道被让了出来，计逸云和小青两个人顺着那条道向祭祀台前走了去，小青紧紧的抓着计逸云的衣角。</p><p>当他们踏上那条道的同时，计逸云感到了生的气息，在他的眼里，先民们都活了过来，而祭祀还在进行着，但是地点已经换到了一个他从没去过的地方，没有人发现他。他像一个旁观者一样，看着祭祀顺利的进行着。当大家对着盘中器物进行参拜时，他看清楚了盘中的事物，竟然是一颗琉璃心，而且不是一般的琉璃心，是一颗七窍玲珑心。</p><p>本来祭祀进行的很顺利，但是当一个中年人骑着快马从外面跑了进来，着一切都变了。他跑向了祭祀台上，振臂大呼，虽然历史久远，计逸云不太懂得什么意思，但大概应该是国家到了危急时刻，他希望能够借助那颗心的力量，力挽狂澜，拯救危难。这些话引起了轩然大波。大家喧闹了起来。有几个重要的人物在一起讨论了一下，决定将琉璃心的力量交给了中年人。</p><p>画面一转，又一次祭祀，这次那个人将心带了回来，但以垂垂老矣，计逸云没想到琉璃心刚归位，那个那人就不行了。本来回来时看他和正常人没什么不一样，但这时，他的心好似被人挖了，胸膛瘪了下去，然后就见那个巫师抱起他仰天大哭，这时计逸云才发现，巫师竟然是个女子。计逸云隐约听到了“比干”这样的声音，他被人拉了一下，心神才回复。发现自己还在山洞里，计逸云大概明白了，正所谓“青山有幸埋忠骨”，这里应该是比干墓吧！</p><p>只是不知为何有这些泥塑，而且琉璃心好像也不见了。比干既然被封为文曲星不应该有这座墓啊！计逸云心中的疑问多了起来。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>', 13, '', NULL, '2018-06-07 09:39:37'),
(76, '第五章  薪火相传 ', '	计逸云伸手去拿那个盘子，这时小青突然喊道“快来看，这里有字！”，原来在两人向祭台走过去的时候被巫师泥塑遮住了视线，没有看他身后的字，只见他身后的墙壁上有八个大字，四字一组用鲜红的涂料并排刻在其上“人族传承，薪火相承”。计逸云连忙走过去观看，字体鲜红如血，气势奔腾如火。染料仿佛刚涂上的一样，悬悬欲滴，计逸云下', 0, 0, '<p><span style=\"white-space: pre;\">	</span>计逸云伸手去拿那个盘子，这时小青突然喊道“快来看，这里有字！”，原来在两人向祭台走过去的时候被巫师泥塑遮住了视线，没有看他身后的字，只见他身后的墙壁上有八个大字，四字一组用鲜红的涂料并排刻在其上“人族传承，薪火相承”。</p><p>计逸云连忙走过去观看，字体鲜红如血，气势奔腾如火。染料仿佛刚涂上的一样，悬悬欲滴，计逸云下意识就摸了上去。传承浮现，火焰骤然升起，火势盛大，光华通天，照的整个广场通透明亮。计逸云身处其中却并没有灼热之感，反而周身温暖之意上升，昏昏欲睡，之中有点点星火围绕在计逸云身上，进入识海组为心决。</p><p><span style=\"white-space:pre\">	</span>原来人族亿万年传承分为心法，身法两大类，身法又为武，法两种，心法里有算法，识法，以下又分多类，而传承只有当传承人符合条件时才能被触发，也就是说身法传承只有传承者体质到达一定的水平时才能被激活，而心法也有同样的道理。两者共同之处就是传承者必须具有人族魂魄，否者不可能得到传承。而计逸云虽是先天之体，本质来讲不属于任何种族，但是他的魂魄却是人族的魂魄，而他的精神力更是少有的强大，这样就符合了传承条件。</p><p><span style=\"white-space:pre\">	</span>计逸云心下暗喜，原来他得到的是算法。有了这篇心诀，可以趋利避害，又可修习法阵之道，阵起鬼神皆惊。得到传承后，传承法阵自然隐去，等待下一位传承者，这就是人族薪火传承的优点，星星之火，广施机缘总有燎原之势。</p><p>小青年纪稍小对于一些没有见过的实物毕竟有些好奇之心，看到那墙壁之上竟然发出百样色彩，万样光华，一时间竟被惊得呆住了，她看了看计逸云，见他脸上竟有种意犹未尽之感，她拉了拉计逸云的衣袖，“前辈，前辈”小声的喊了两句。季逸云竟是醒都未醒。</p><p><span style=\"white-space:pre\">	</span>传承似乎转瞬即逝，但其实经过了好长时间季逸云才清醒过来。七窍琉璃心其实是算法神器，也是算法正宗的载体，有着趋吉避凶之功效，由天地初生之时云石之精组成。</p><p>云石本就是天地初开之时的罕见产物，本就有着天下至理的道痕，而天地之精更是少有的可怜，本就是昂贵之物，后来阴差阳错的到了燧人氏的手中这才成为了算法神气。</p><p>“想来，经过了这一支人族前辈们的不断雕琢与磨合，现如今大概只有人族强者才能够掌握并运用了吧。”季逸云心中笑道,虽然没有得到珍贵的算法神器，但现在看来倒也不算吃亏，就算自己得到也不一定能够利用的好啊。</p><p>其实季逸云同学一项都信奉“知足者常乐”这句话的。他转身一看，竟发现小青在不知不觉中躺在他旁边睡着了，季逸云嘿嘿一乐，心道“这丫头心到底有多大啊，这种环境睡都能睡着”。季逸云也没有吵醒她，而是在她旁边坐了下来，理了理这些天发生的事情，这两天的事情离奇的简直就像是一个梦。</p><p><br/></p><p>。。。。。。。。。。。。。。。。。。。。。。。。。。。</p><p><br/></p><p>天气已经渐渐的黑了，本就是晚秋季节，本来就有些寒冷的傍晚就更加的阴冷和寂静了。宁采臣拨了拨已经没了火星的篝火，叹了口气，看了看外面漆黑如墨的天空。计逸云竟然还没哟回来，虽然自己和计逸云刚刚相识，但去有一种已经相交多年之感。想来自己虽然脾气秉性都是上乘的，但由于自己性子软弱，竟在这么多年下来无几人相交到达如此境地。计逸云和自己认识不到一天，却为自己卷入这和他毫不相关的事件中来，想了想竟觉得自己有些对不起他。想到这里宁采臣手里又无意识的拨了拨那堆燃尽的灰堆，他站起身竟对外面的一片漆黑再也没有一点畏惧之心。想了想，五步并做三步向外面冲了出去。</p><p><br/></p><p>。。。。。。。。。。。。。。。。。。。。。。。。。。。。</p><p><br/></p><p>“喂，你这人在想什么啊！”计逸云在不知不觉中竟入了定，突然听到这样一句话，转眼一看，竟是小青已经醒了过来，正在歪着头看着他，脸上一脸迷惑的神彩，小嘴微张，就像一个好奇宝宝一样。</p><p>“没什么，就是有点迷惑这里是干什么的地方”计逸云并不想把刚才看到的情景告诉她，毕竟此事关系重大，如果有什么隐藏的情况，怕是会对小青不利。他虽然刚刚认识小青，但是却觉得小青为人可爱，而且很对他的胃口。本来把她骗到这里就已经觉得有点对不起她了，这样有危险的事还是少知道一些的好。毕竟比干现在身为文曲星官，掌管天下文脉大事，这可不是一般的小小天官能够比拟的，当真没想到当年身为商朝丞相的他还有此等渊源，竟是血脉如此纯净的人族血脉后代，如果有等级制度划分的话，他体内流淌的岂不是初级血脉吗。</p><p>计逸云见小青已经休息的差不多了，就是再次起身道：“我们走吧”，旋即大踏步的向前走了过去，小青本来还想再说点什么，但看到计逸云已经出发，只能无奈的跺了跺小脚，撇撇嘴，哼了一声，继续跟上来了。洞穴再往里走幽深恐怖，竟是越走越窄，毕竟无人光顾，青苔遍地，两个人走在其中，回声悠长深远，竟似幽鬼长号之声，让人胆寒，小青向前凑了凑，不知不觉中已经抓住了计逸云的衣角。计逸云嘴角轻轻一撇，也不说漏，就这样让她抓着，他自己都没有注意到，他已经慢慢放慢了脚步。</p><p><br/></p><p>。。。。。。。。。。。。。。。。。。。。。</p><p><br/></p><p>宁采臣走到林中突然发现自己并不知计逸云离开时的方向，这让他如何去找，他心中焦急，而林中本就阴森可怖，松柏丛生，灌木密集，他想要回头时却发现竟已经找不到回去时的路了，“嘻嘻嘻”这时候银铃般的笑声传来，他定睛看去，竟是再也转不过神来。</p><p><br/></p>', 13, '', NULL, '0000-00-00 00:00:00'),
(77, '第六章  绝代芳华 ', '远山重重叠叠，波澜起伏，古树林立，风止与林前，那林间正有一女子悄然而立，她身穿一身素白色的长裙，上面镶嵌着暗金色的图案，好像是一朵朵的祥云，腰间系着一根淡黄色的绸带，将那身材衬托得淋漓尽致。脑前齐分刘海，又分别从两边绕到脑后在发尾用一根亮蓝色的绸缎束成一体。修长的身材在月光下竟然分外的迷人，此时静静的立在林间', 1, 0, '<p>远山重重叠叠，波澜起伏，古树林立，风止与林前，那林间正有一女子悄然而立，她身穿一身素白色的长裙，上面镶嵌着暗金色的图案，好像是一朵朵的祥云，腰间系着一根淡黄色的绸带，将那身材衬托得淋漓尽致。脑前齐分刘海，又分别从两边绕到脑后在发尾用一根亮蓝色的绸缎束成一体。修长的身材在月光下竟然分外的迷人，此时静静的立在林间，亮晶晶的眼睛正在注视着宁采臣。</p><p>不知何时，月正当空，林间婆娑月光洒落，空间竟似宁静了许多，只有远处传来不知名的动物低沉的嘶吼声音，山林之中风声不知不觉中停住了，仿佛世间万物皆在屏息而立，生怕破坏了这一时刻的场景。是了，《诗经》中《周南·桃夭》篇有：“桃之夭夭，灼灼其华。”大概正是再形容这种绝代芳华吧。</p><p>宁采臣目瞪口呆，他怎么会想得到在这种深山老林中竟然会有这种神仙般的女子，他的心怦然而动，自己都有些控制不住了，那女子见他一声不吭，脸涨得很红，一副猪哥的样子，竟然“噗呲”一声笑了。</p><p>“这位公子，奴家聂小倩在这厢有礼了”小倩微微一欠身。</p><p>“哦哦，小生宁采臣这厢有礼了”宁采臣抬了抬手。</p><p>“不知这位姑娘在这深山老林中干嘛，可是迷路了”宁采臣开口道。</p><p>聂小倩也不答话，只是定定的看着他，两只眼睛竟是泫然欲滴，突然她嘻嘻的笑了，喃喃自语道“我这是怎么了，三拜九叩都过来了，这都到最后一步了，有什么好哭的”。</p><p>“姑娘，你怎么了，迷路了也不要紧的，我们两个一定能够找的出去的”，宁采臣心想，这姑娘该不是疯了吧。</p><p>“哪里，我只是和公子三生修好，今世特地应约而来罢了”聂小倩银铃般的笑声又响了起来。</p><p>什么，宁采臣大吃一惊，他转瞬间竟然起了无数想法，</p><p>“她要是硬上我，我该从是不从，我可是纯情好男孩，怎么能这么随意，她打死我也不从”</p><p>“额，她这么漂亮，要不我还是从了吧”此类想法纷至沓来。</p><p>在他还在乱想的时候，突然觉得脑袋一痛，就天旋地转一样失去了意识，在他身后小倩身边立了一根比她身体还粗的狼牙棒，那条棒子竟不像普通的狼牙棒，因为那上面没有齿，通体骨质的惨白。</p><p>聂小倩拍了拍手喃喃自语道“哼，真是费老娘的劲，老娘怎么会喜欢上这个废物，还一喜欢就犯贱喜欢了他三辈子”。</p><p>“算了，算了，其实他也不是每辈子都这么窝囊，想他上辈子不也是为国为民的大英雄吗”</p><p>她绕着宁采臣转了几圈，嘴里不停地念叨着一些奇怪的话语，也不知在想一些什么事情，脸不知不觉中就红了，“哎呀呀，我在想什么啊，真是的”她捂了捂自己的脸，一脸不好意思的样子，宁采臣如果看到她这幅样子，一定会再次晕过去的，他怎么会想到自己心中女神竟是这种逗比。。。。。</p><p>“好了，只要将那件宝物拿到手，帮他恢复记忆，我们两个的历练就算完成了，就可以回师父那里交差了”聂小倩一把拎起计逸云的身体，那样子就像拿一个娃娃一样轻松。</p><p>“老黄，老黄，你死哪去了，快点给我出来”</p><p>“汪汪，主人我在这呢！”只见一颗树上正坐着一条通体土黄的老狗，翘着个二郎腿，一只爪子里是油花花的的半只烤鸭，另一只爪子上拿着一个比它脑袋还要大的酒葫芦，一见聂小倩喊它，顺手将两件东西一撇，那两样东西竟然消失不见，快速的从树上溜了下来，蹲在聂小倩面前，两只爪子搭在身前，看它的眼神竟然比狐狸还要皎洁。</p><p>“你这条死狗离我远点，一身酒味，当年要不是他收留你，我管你死活，哼，去把我那根狼牙棒背着”</p><p>“啊，又是我，不要啊，那条棒子那么沉，哎，为什么受伤的总是我”老黄虽然唉声叹气，但还是把那根狼牙棒背了起来。</p><p>“走吧！”聂小倩斜了它一眼，一人一狗旋即消失在沉寂的夜色之中。</p><p>过了一会。从树林中钻出来一个中年道士，他身后背了一把长剑，一身道袍破破烂烂，唯独那把剑的剑鞘如同新的一般，他喃喃自语了几句话，竟然也消失在了同一方向。</p><p><br/></p><p>。。。。。。。。。。。。。。。。。。。。。。。。。</p><p><br/></p><p>洞中黑暗异常，计逸云和小青走在其中，只有轻微的脚步回响，计逸云用法术照亮的蓝光映射在两个人的脸上，竟然有一些略微的渗人之感，虽说小青是修道之人，但毕竟修为不高，再加上年龄尚小，大概人族少女十七八的年龄，对于黑暗还是有些害怕的，脚步一再放慢，到最后好似挪动一般。</p><p>计逸云心中好笑，他突然开口道“小青姑娘，不知你的师父是哪位能人，和我说说，说不定我们还沾亲带故的哩”。说起来他在这个世界哪有什么亲戚啊，这样说不过想要活跃一下气氛。</p><p>“啊，啊，哦，我师父出来时跟我说不让我向外面人提起他的名字，他说他的仇人太多，不提他还好，提起他来说不定寸步难行。”小青哪里会想到计逸云会突然说话，有些反应不过来。</p><p>“哦，是这样啊，想来你师父必是一代大能啊，他一定对你很好吧”计逸云说道。</p><p>“切，就他，得了吧，一副贼眉鼠眼的样子，一点没有真正能人那种仙风道骨的感觉，而且我从来都没见过他动手，他的口头禅是’能用嘴遁，尽量别动手’，你说这样的人能是大能吗？”</p><p>“额，这！”计逸云竟然不知道该如何接下去。</p><p>“不过呢，有一点你说对了，他对我确实不错，我从记事起就跟在他的身边，但是确是他座最小的师妹，虽然总是和我们说要对我们严格，但是却从未见过他惩罚师哥师姐们，每天都一副和颜悦色的样子，他总是为老不尊，但是却格外可爱”不知不觉中小青放松了心情，两个人加快了脚步，洞穴里不时传来小青那动听的笑声。</p><p><br/></p>', 13, '六', NULL, '2018-06-07 09:31:24'),
(78, '第七章  冥芸律夜 ', '季逸云和小青走在狭窄的山洞里，本来还很宽敞的山洞越是往里越是狭窄，两个人也是愈发的紧张，妖气越来越重，空气中弥漫着一股紧张的气氛。转过了几个弯，前方光线慢慢透了出来，竟有一种山重水复疑无路，柳暗花明又一村之感。见到出口就在眼前，季逸云放轻了脚步，单手捏着法诀，随时就可以发起雷霆一击。两人又向前走了几步，只觉得', 1, 0, '<p>季逸云和小青走在狭窄的山洞里，本来还很宽敞的山洞越是往里越是狭窄，两个人也是愈发的紧张，妖气越来越重，空气中弥漫着一股紧张的气氛。转过了几个弯，前方光线慢慢透了出来，竟有一种山重水复疑无路，柳暗花明又一村之感。见到出口就在眼前，季逸云放轻了脚步，单手捏着法诀，随时就可以发起雷霆一击。</p><p>两人又向前走了几步，只觉得豁然开朗，季逸云和小青怎么也不会想到，这山竟然是空的，山顶形成了一个大大的天窗，这山体内竟有一个隔绝外界的世外桃园。这个时候月光透过山顶，将四周照的明晃晃，只见山体最中间有一座天然湖泊，水面平静，竟有一种凝重之感，让人觉得泛不起一丝波纹，湖水通体碧蓝。在月光的照射下，就如同一块年代久远的古玉一般，幽深温婉，熠熠生辉，又好似一方明镜一般，将周围的景色囊括其中。那座湖水圆的让人找不到一丝的不协调之感，此时与那天上明月相对着，当真是二月争辉。再看那湖水之滨，无数的天河星光一般亮晶晶沙子洒落其中，就像阳光照射下来的尘灰一样细腻。再往远处看过去，一棵偌大的老槐横亘在洞口的正对面，远远望去依旧有着遮天蔽日之感，竟是单棵为林，那一棵棵气根从老槐的枝干上延伸出来，扎根在这幽谷的土地上，好似要将它那一片的营养和水分全部吸干一样，当真是自成世界一般。</p><p>季逸云本来觉得像是姥姥这一级别的精怪并不算是十分的棘手，但现在看来并不可能如此轻松，想来也是，这毕竟是圣人学府截教的入学考试，这次历练评级必定会涉及到将来季逸云在截教新晋学子的地位。如果这次考核十分的简单，对于截教弟子并不能起到考核作用，相对的，截教也被新晋弟子所轻视，这对双方来讲都是不利的。季逸云想了想，还是决定自己先去试一试底，他刚想对小青说说他的想法，就听得身后的洞口中传来了狗叫声音并伴随着轻微的喝骂声，他和小青连忙转身看过去。</p><p>“汪汪，本汪不干了，凭什么脏活累活都叫本汪干，不带这样欺负狗的，还让不让狗活了，汪汪”声音越来越近。</p><p>“你这条死狗，脏活累活不爱干，轻巧的却又干不了”一个银铃般的声音怒斥道。</p><p>“汪，你这是站着说话不腰疼，你还真是有脸说你那个轻巧活，你居然让本狗一条公汪变成一个美女去诱惑一个老头子，这种事你竟然说的出口，汪”</p><p>“额。。切，你这条死狗离我远点行不行，你那条狗尾巴，又碰到我了。我说，你一天天的晃荡个屁啊，信不信明天本姑娘帮你切了，让你这辈子都不能晃了！”女子的声音有一点卡顿，但旋即又满不在乎的转移了话题。</p><p>“砰”旋即听得那条狗哀嚎了一声“嗷呜，你能不能别踢本汪的屁股”</p><p>季逸云与小青相对看了一眼，皆是看到了对方眼中的笑意。他二人望向洞口，只见一条大黄狗和一位美女相继从洞口走了出来，季逸云和小青顿时一愣，小青被那条大黄狗的扮相惊呆了，只见那条大黄狗一只爪子上抓着比他脑袋还要大的酒葫芦，另一只手弯曲的端在胸前，耳朵在脑袋的两边竖立着，舌头深处老长，背后背这一根粗粗的不带刺的狼牙棒，整个一人类好朋友的扮相，她不由得嘿嘿一笑，再说季逸云竟是被那美女惊呆了，如同宝石一样发亮的眼睛，长发飘飘，再加上一身素色的长裙，竟如仙女一般。当然，如果不算她右手拎着的宁采臣的话，堂堂七尺男儿竟如同一个布娃娃一样让她拎着一旁。</p><p>在他二人愣住的同时，对面两人也有点发愣。好吧，不应该说是两个人，应该是一人一狗，他们两个也有点懵，他们当然不会想到这里还有两个人。</p><p>就在两方人略微尴尬的同时，只听得一声呻吟声音响起，竟是宁采臣苏醒了过来。只见他揉了揉脑袋道“这是哪啊？”他这一声刚好打破这短暂的平静。四个人顿时戒备起来，那女子也将宁采臣放下，宁采臣转身坐了起来，刚好看到季逸云，连忙起身行礼道“云兄，我找的你好苦啊”季逸云略微一皱眉，他与宁采臣认识的这两天，相谈甚欢，本来不欲让其涉险，但如今他还是到了这里。</p><p>“哈哈，没想到道长竟是夫君的朋友，那便是我的朋友，在下聂小倩，不知这位道长怎么称呼”旁边的聂小倩突然说道。</p><p>“你是谁，谁是你夫君”宁采臣此时已经有些懵了，他转头看了看季逸云又问道“这，云兄，你何时成了道士”</p><p>“哎，这件事一言难尽啊”季逸云并不想当着小青的面说自己是假道士的事情，他转过头对着聂小倩道“聂姑娘，不如先说说你的事情”。</p><p>片刻之后。。。</p><p>原来这聂小倩与宁采臣竟是三生三世的缘分，他二人本是一大修真门派同门师妹关系，却因与人争斗，宁采臣为了保护聂小倩，竟然差点让人打得魂飞魄散，不得以请求他二人的师父施展大法力保住真灵不灭遁入轮回，历经三世修养，这一世终于修补的差不多了，可以承受的住药物等外力的作用了，聂小倩想回师门求助他们师父帮助宁采臣觉醒上一世的记忆，而这药物刚好在这黑山之中</p><p>话说这黑山虽说是洪荒世界普普通通的一座山峰，但是却也有着非同一般来历，话说自盘古开天辟地，盖天下生灵之长者为三。龙，盘古动脉所化，掌天下水脉。凤，为盘古毛发所化，掌天下焰火。麒麟，为盘古脚趾所化，掌天下沃土。但开天辟地之后，浊气未消，三族心智被蒙蔽。</p><p>他三族本就有所争斗，惊人挑拨，再加上互相都是暴脾气，正所谓不服就干，导致第一次大劫彻底被引爆，最后三族伤亡惨重，只好退出了历史舞台。</p><p>后历经巫妖大战，厚土娘娘不忍看天下苍生死后灵魂就此消散，慈悲为怀，牺牲自我创六道轮回，天下浑浊之气下入幽冥经过六道轮回最终与天下生灵之气互相循环生生不息，其实这两者本就同根同源，互生互克。</p><p>当年水神共工与火神祝融相争，不得胜怒撞不周山，不周神山乃是盘古脊梁所化，钟灵所属，是承天之柱，它这一断，天地变色，这才有了女娲娘娘炼石补天之说。</p><p>而这黑风山也是当年不周神山的一部分，它本来并没有什么他过于出色的地方，说多了也就是一块颇有灵秀的地脉而已，但在厚土娘娘化身轮回之后，它吸收了不知多少天地之间的幽冥之气，也就是盘古开天辟地之后所留下的浑浊之气，它与生灵之气本是同根同源，后来经过几千万年的沉淀生成了一种名叫冥芸律液的宝物。正所谓阴极生阳，虽然这种宝物是由天下至浊之气所化，但是他其中却含有很大的生灵之气，可以说生死人肉白骨对它来讲就是小菜一碟。</p><p><br/></p>', 13, '', NULL, '2018-06-07 09:31:15'),
(79, '第八章  团队副本姥姥 ', '说到这里，小倩略微抬起了头，修眉略微轻轻一挑，才继续说道：“冥芸律液固然是生死人肉白骨的好东西，但它毕竟是由成千上万年幽冥浊气所积聚而成，从某种意义上来说，它也是天下至毒之物，为了能够成功的将其内在大量生灵之气激发出来，我们需要一枚药引子，而这枚引药之物也正是冥芸律液之所以能够聚积在这里形成如此大的湖泊缘由所', 8, 0, '<p>说到这里，小倩略微抬起了头，修眉略微轻轻一挑，才继续说道：“冥芸律液固然是生死人肉白骨的好东西，但它毕竟是由成千上万年幽冥浊气所积聚而成，从某种意义上来说，它也是天下至毒之物，为了能够成功的将其内在大量生灵之气激发出来，我们需要一枚药引子，而这枚引药之物也正是冥芸律液之所以能够聚积在这里形成如此大的湖泊缘由所在。”</p><p>小青接口道：“倩姐姐放心，这件事我必定帮忙到底。想必季少侠也是吧，嗯，你这个大坏蛋”小青此时双眼泛着泪花，想必是被小倩和宁采臣之间的爱情故事给感动的差点落泪。</p><p>“嗯，当然了，攘奸除恶是本少侠的职责说在”季逸云苦笑一下，他知道以小青的冰雪聪明哪里还不知道他是个假道士，说着他又把自己的衣服变了回去。</p><p>“哇，帅哥，没想到你这样帅，等等我和我师兄说说，让他自己回山，小帅哥我两个双宿双飞如何。”聂小倩一副犯了花痴无可救药的样子。</p><p>“额，她要是强上我，我从是不从。。。。。。。”季逸云脑子瞬间短路，不过转瞬间就恢复了过来“额，我这是在想什么啊，莫不是小倩长得太过好看让男人瞬间产生龌龊思想。。。，额，不对啊，话说这是一种什么毙了狗的画风啊，她真的陪同她师兄三生三世吗，为什么看着宁采臣竟有一种看垃圾的冲动，说撇就撇啊，就算是要勾搭其他男人也要背后做啊，要不要这么明显”季逸云一脸懵逼的看着聂小倩。</p><p>再看宁采臣和小青一脸的惊呆模样，嘴巴张的老大，简直要成为两只望月吼了。</p><p>那只大黄狗见怪不怪，只是双爪护住自己的眼睛，蹲在那里，硕大如扫把的尾巴在后面一摇一摇的，一副我家主人要不要这么彪，我不要认识这个主人的样子，这个样子浑然天成就好像每天要做千百次一样。</p><p>聂小倩也觉得略微有点不妥，她正了正自己的银簪，板了板脸，装出一副很是严肃的样子继续道：“而这湖下的宝物就是冥芸律石，也正是由于冥芸律石，天地浊气才能够如此的汇聚其中，冥芸律石虽然和冥芸律液看似同源，但却并非如此，这冥芸律石乃是开天辟地之出混沌原石所化有着最纯粹的生机之力，但是数量上面确实有所不足，只能够充当药引之物，</p><p>而我们的对面正有一个成道多年的老妖守护着这片湖泊，但相对的，这冥芸律液对天下植物都十分的克制，她此时没有对我们出手也正是因为对冥芸律液有所顾忌，我们一旦想要取走这冥芸律液和那块石头只能打败她，除此之外别无他法。”</p><p>她说到这里看了看季逸云和小青二人，季逸云和小青点了点头，示意明白。</p><p>“我最近卧底在她身边，觉得以我当前的实力怕是对上姥姥讨不得任何优势，在湖泊那边姥姥自成一片天地，但相反的，出了这个范围，她就做不了任何事情了。这是我们的优势，一旦打不过姥姥就可以撤出那个范围，她就望尘莫及了，我本想一人去会会她，但没想到今日遇见了你们，当真是天意。”聂小倩继续分析道。</p><p>“这姥姥乃是槐树成精，五行之间相生相克，想来她一定对火有所惧怕，是否在这个方面有些准备”季逸云皱着眉头道，他对姥姥的情况一点也不了解，也没想到情况会是这么棘手。</p><p>聂小倩轻轻点了点头道：“请少侠放心，这方面我还是有一些准备的，我找已经在姥姥不知情的情况下在她的各大气根之下埋下了地火之精组成奇火阵，到时候我们点燃其中一个就会点燃全部的地火之精，到时候就算姥姥还有战力恐怕也所剩无几，到时我们齐上而攻，估计她撑不了太久”。</p><p>“嗯，这样还好”季逸云点了点头表示赞成。</p><p>“等一会宁兄就在这里稍等片刻，我们过去试探一下虚实”季逸云想了想有转头对着宁采臣说道。</p><p>“云哥儿，等一等”宁采臣叫住季逸云，又看了看其他几人欲言又止。</p><p>“宁兄，有事但说无妨”季逸云对宁采臣说道。</p><p>“我觉得这件事情这样的危险，你们还是别去了吧！我就这样也挺好。重来没有想过要觉醒上一世的记忆。”他偷拿眼神瞧了瞧聂小倩，见她阴沉着脸但却并没有什么表示，就小心翼翼的继续说道“再说了，我这一世还有老母在家，如若像小倩姑娘说的的一样和她回归山门，我的老母谁来奉养。而且记忆觉醒后我究竟是我还是另一个人”。</p><p>小倩突然捂嘴笑了起来道“嘻嘻，夫君想多了，你觉醒上一世的记忆后你还是你，就像是经过了很多事情但是经过的时间不同罢了，你我二人三世姻缘，做了三世夫妻，你的母亲自然也是我的母亲，实在不行你我二人将她接上山门也是可以的”。她说完这一席话，突然小嘴一撇，两只眼睛亮晶晶的，轩然欲滴说道“夫君，你我二人三世姻缘好不容易才要修成正果，长长久久的在一起，难道，你要让我之前的努力全部白费吗？呜呜。。”说着说着经要哭出声来。</p><p>宁采臣固然是喜欢聂小倩的，他二人本就是上天已经定下的姻缘，心有灵犀得很，再加上小倩正是宁采臣梦想中的姑娘，如今见她一哭，也软下心来，道：“好吧，那就有劳诸位了。”</p><p>聂小倩旋即破涕为笑，脸上神情转变之快竟让季逸云怀疑她之前的样子是不是装出来的。</p><p>将宁采臣留在原地，季逸云三人一狗绕过山洞中间那个湖泊，打算集体刷一下副本槐姥姥，他们几人绕过中间的那个圆润如玉的天然湖，刚走一半只觉得天地变色，本来还月光如水般静谧，转瞬间就好像转换了时空一般，世界变成了红棕色，阴暗可怖，老槐树的枝干竟然密密麻麻一眼望不到尽头。</p><p><br/></p>', 13, '', NULL, '2018-06-22 15:22:47'),
(90, '第一篇博文 ', '这是这个网站的第一篇博文，一直都想做一个自己的博客，但我这个人相对较懒，没有缘由，我可能一辈子都完不成这个任务。这次借着做毕业设计的机会，刚好完成想了几年也没动手去做的事情。', 19, 0, '<p style=\"line-height: 1.5em; text-align: left; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\">这个博客在2018年4月</span><span style=\"text-indent: 2em; font-size: 20px;\"></span><span style=\"font-size: 18px; text-indent: 2em;\">完成了，写这篇博文的时候是博客刚刚完成了后台功能，前台界面我还没有写，但是我抑制不住自己写这篇博客的欲望。在大学四年跌跌撞撞也算是做了人生旅途这一阶段的路程吧，我一直相信人生的每一段旅途应该完成的事情是不同的，而我的大学生涯过的并不算很华丽，但是确让我感到清晰和完整。人们都说大学生涯应该是轻松和快乐的，对于这件事我深以为然，追一下自己喜欢的姑娘，干一些自己喜欢的事情，或者交上一大群同样不求上进的朋友。大学时间过的真是快，一不小心自己就临近毕业，工作当然很辛苦，但是人生不可缺少的一部分。最后以此文章证明我大学生涯的结束和这个博客的起始。</span><br/></p><p style=\"line-height: 1.5em; text-align: center; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\"><img src=\"/tp50/public/upload/image/20180418/1524041983.jpg\" title=\"1524041983.jpg\" alt=\"9f3d80e7e814a80588434bda4c2a6843.jpg\" width=\"611\" height=\"300\"/></span></p>', 5, '', NULL, '2018-06-22 15:20:01'),
(93, 'thinkphp5部署workerman长连接 ', '由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman', 54, 0, '<p style=\"text-indent: 2em; line-height: 2em;\">由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman，在之前我曾经利用workerman进行聊天软件的编写，实现多人在线聊天功能，而在这之前我没有将这个博客编写成功，本次趁着这个机会，我将长连接的知识进行了复习，正好博客完成时间没有多久，于是将这次经历记录在案，以备以后自己查看学习，也方便了看到这个博文并且可能需要用到该框架的同学们。最后，<span style=\"text-indent: 32px;\">我需要感谢一位同学，他在这个项目中帮助了我很多，</span>。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在进行该教程之前，我们需要了解一下workerman这个框架和thinkphp这个框架，thinkphp框架是PHP几大框架之一，想要了解的同学们可以到<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\">ThinkPHP5.0完全开发手册</a>上进行文档的阅读，以下简称tp5，tp5框架是国产为数不多的优秀框架之一，国产的哦！<img src=\"http://img.baidu.com/hi/jx2/j_0007.gif\"/>而workerman则是在<a href=\"http://www.workerman.net/\" target=\"_self\" title=\"workerman\">workerman</a>官网上有详细的介绍，同学们可以到该网站上进行手册的查看。</p><p style=\"text-indent: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\" style=\"text-indent: 32px; white-space: normal;\">ThinkPHP5.0完全开发手册</a>里面有一篇介绍他们两个融合的文章<a href=\"https://www.kancloud.cn/manual/thinkphp5/235128\" target=\"_blank\" title=\"composer包workerman\">composer包workerman</a>在这篇文章里介绍了tp5融合workerman的教程，但是介绍的过于简洁，我试验了两次并没有走通，而在这次的记录中我将我的融合过程和这个方法进行对比，分析以前没有走通的原因。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em;\">不论在哪个方法中，我们都需要将wokerman的包引入，我们需要用到composer，没有安装composer的同学需要自行安装。</p><p style=\"text-indent: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第一步</h1><p><br/></p><p style=\"text-indent: 2em;\"><span style=\"text-indent: 2em;\">导入workerman包：</span></p><pre class=\"brush:html;toolbar:false;\">composer&nbsp;require&nbsp;topthink/think-worker</pre><p style=\"text-indent: 2em;\">&nbsp;如果<span style=\"color: rgb(255, 0, 0);\">windows服务器</span>还要利用以下命令：<br/></p><pre class=\"brush:bash;toolbar:false\">composer&nbsp;require&nbsp;workerman/workerman-for-win</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">如</span><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">运行出现错误PHP Fatal error: Call to undefined function Workerman\\Lib\\pcntl_signal()，需要删除vendor\\workerman\\workerman，防止命名覆盖。</span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">当包引入完成后，我们会在项目根目录下的vendor文件夹下看到workerman文件夹，这样框架就引入了该项目，我们下一步需要配置服务的启动和引用。</span><br/></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\"><br/></span></span></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第二步</h1><p><br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">在这一步中我们需要将启动服务文件放入到项目根目录中，在根目录中我们新建启动服务文件server.php<br/></span></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\">代码如下：</span></span></p><pre class=\"brush:php;toolbar:false\">#!/usr/bin/env&nbsp;php\n&lt;?php\ndefine(&#39;APP_PATH&#39;,&nbsp;__DIR__&nbsp;.&nbsp;&#39;/application/&#39;);\n//这是原来的代码\n//define(&#39;BIND_MODULE&#39;,&#39;push/Worker&#39;);\n//这是我修改后的代码\ndefine(&#39;BIND_MODULE&#39;,&#39;push/Workertest/index&#39;);\n//&nbsp;加载框架引导文件\nrequire&nbsp;__DIR__&nbsp;.&nbsp;&#39;/thinkphp/start.php&#39;;</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\"></span></span>这个代码的意思是绑定workerman的模块是/application/push/Worker这个控制器，但是由于我们没有用tp5这个框架的引用方式这里我们将代码改为如上所示，直接进入到控制器的index方法，在下一步我们会介绍为什么用这种方法。我们在下一步中就会定义模块，也就是实现功能的地方：/application/push/workertest.php<br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第三步</h1><p><span style=\"color: rgb(255, 0, 0);\">在这一步开始前我们来看一下tp5开发手册中的worker.php，需要声明的是我并没用利用该方法。</span></p><p style=\"line-height: 2em; text-indent: 2em;\">&nbsp;&nbsp;&nbsp;&nbsp;一共有一个变量和5个方法，变量是定义端口和域名的，方法是分别为，连接上时，服务开始时，接到信息时，错误时，断开时的相应处理方法。</p><p>代码如下</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;think\\worker\\Server;\nclass&nbsp;Worker&nbsp;extends&nbsp;Server{&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;$socket&nbsp;=&nbsp;&#39;websocket://push.app:2346&#39;;&nbsp;&nbsp;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;收到信息\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$data\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onMessage($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&#39;我收到你的信息了&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接建立时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onConnect($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接断开时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onClose($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当客户端的连接上发生错误时触发\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$code\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$msg\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onError($connection,&nbsp;$code,&nbsp;$msg)\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;error&nbsp;$code&nbsp;$msg\\n&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;每个进程启动\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$worker\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onWorkerStart($worker)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"text-indent: 2em; line-height: 2em;\">如果用tp5给出的方法，我们需要在其他的控制器中实例化该控制器类，而在我用到该框架时没有看出该用法，误以为实现功能直接在该控制器中调用即可，当我利用到tcp链接时出现了两个链接的同时调用，在tp5文档中的这个方法，我无法同时实例化两个链接，于是我放弃了该方法，想要研究的同学可以继续研究一下，下面给出我的方法。</p><p>workertest.php代码如下：</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;Workerman\\Worker;\nuse&nbsp;Workerman\\Lib\\Timer;\nuse&nbsp;Workerman\\Connection\\AsyncTcpConnection;\nclass&nbsp;WorkerTest\n{\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connections;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connection_to_ws;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index()\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$connections&nbsp;=&nbsp;array();&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket&nbsp;=&nbsp;new&nbsp;Worker(&#39;websocket://0.0.0.0:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;设置transport开启ssl，websocket+ssl即wss\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$socket-&gt;transport&nbsp;=&nbsp;&#39;ssl&#39;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;启动1个进程对外提供服务&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;count&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//给这个进程设置一个array（）\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onConnect&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;lianjie&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onMessage&nbsp;=&nbsp;function($connection,$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(json_decode($data));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$jdata&nbsp;=&nbsp;json_decode($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($jdata-&gt;tem))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($con-&gt;endno)&amp;&amp;isset($jdata-&gt;endno)&amp;&amp;$con-&gt;endno==$jdata-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send($jdata-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;数据已接受&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;endno=$jdata-&gt;endno;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接断开时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onClose&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($connection-&gt;id))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;连接断开时删除映射\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset($this-&gt;connections[$connection-&gt;id]);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp&nbsp;=&nbsp;new&nbsp;Worker(&#39;tcp://0.0.0.0:8282&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp-&gt;onMessage&nbsp;=&nbsp;function($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_null($this-&gt;connection_to_ws))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(&#39;connect&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws&nbsp;=&nbsp;new&nbsp;AsyncTcpConnection(&#39;ws://119.29.170.92:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;connect();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;send($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($con-&gt;endno==json_decode($data)-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send(json_decode($data)-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;运行worker&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worker::runAll();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"line-height: 2em; text-indent: 2em;\">每当前端浏览器通过websoket上传给服务器对应终端号，workerman就会将本链接放入到队列，与此同时，我通过tcp获取到硬件的值，并经过AsyncTcpConnection这个workerman对象将由tcp端口获取的值转发给websoket端口，再由websoket进行遍历当前队列链接的前端浏览器，通过终端id查找并推送给对应的前端浏览器。<br/></p><p><br/></p>', 16, '', '2018-05-30 09:49:40', '2018-06-23 00:46:54'),
(94, 'php实现的简单的文件上传对比替换程序', 'php实现的简单的文件上传对比替换程序。通过上传压缩包，程序会解压文件，并与已存在文件进行比较，进行文件更新。只支持zip压缩文件上传。', 51, 0, '<p style=\"text-align: center;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\">php实现的简单的文件上传对比替换程序</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">毕业季无聊，突然想做个代码上传对比替换更新的程序，于是花了一两个小时做出来玩玩，正好借朋友的博客写一下。</span><br/></span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">程序通过浏览器上传zip压缩文件到服务器，服务器程序解压后将文件与原有文件一一比对，不同就用上传的新文件替换老文件。完成后删除临时解压的文件。</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">前端不用过多说明，就是简单的form表单文件上传。代码如下：</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><pre class=\"brush:html;toolbar:false\">&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&nbsp;lang=&quot;en&quot;&gt;\n&lt;head&gt;\n&lt;meta&nbsp;charset=&quot;UTF-8&quot;&gt;\n&lt;meta&nbsp;name=&quot;viewport&quot;&nbsp;content=&quot;width=device-width,&nbsp;initial-scale=1.0&quot;&gt;\n&lt;meta&nbsp;http-equiv=&quot;X-UA-Compatible&quot;&nbsp;content=&quot;ie=edge&quot;&gt;\n&lt;title&gt;上传文件&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form&nbsp;action=&quot;upload.php&quot;&nbsp;method=&quot;post&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&gt;\n&lt;input&nbsp;type=&quot;file&quot;&nbsp;name=&quot;files&quot;&nbsp;accept=&quot;application/zip&quot;&gt;\n&lt;button&nbsp;type=&quot;submit&quot;&gt;上传&lt;/button&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><p><br/></p><hr/><p><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">压缩包上传服务器获取后需要解压缩，我用到了php的zip扩展。主要用到了其ZipArchive的numFiles属性和getNameIndex方法。numFiles获取压缩包中文件数量，getNameIndex方法说明如下：</span></p><pre class=\"brush:php;toolbar:false\">string&nbsp;ZipArchive::getNameIndex&nbsp;(&nbsp;int&nbsp;$index&nbsp;[,&nbsp;int&nbsp;$flags&nbsp;]&nbsp;)</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">功能是获取指定下标的文件的名字<br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">除此之外，还用到了pathinfo用于获取路径信息，copy用于将压缩包中文件复制到指定目录，具体代码如下：</span><br/></p><pre class=\"brush:php;toolbar:false\">function&nbsp;decompressing_file($files)\n{\nif($files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/zip&#39;&nbsp;||&nbsp;$files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/x-zip-compressed&#39;)\n{\n$zip&nbsp;=&nbsp;new&nbsp;zipArchive();\nif($zip-&gt;open($files[&#39;tmp_name&#39;])&nbsp;===&nbsp;true)//打开zip文件\n{\n$filepath&nbsp;=&nbsp;md5(time().$files[&#39;name&#39;]);\nmkdir($filepath);//创建临时解压目录\nfor($i=0;$i&lt;$zip-&gt;numFiles;++$i)//遍历压缩包中所有文件和目录\n{\n$filename&nbsp;=&nbsp;$zip-&gt;getNameIndex($i);//获取当前下标的文件或目录名\n$fileinfo&nbsp;=&nbsp;pathinfo($filename);//获取文件或目录路径信息\nif(!file_exists($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]))//判断当前文件的目录是否存在，不存在创建\n{\nmkdir($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]);\n}\n//由于获取的文件或目录名唯一的区别就是目录名最后是‘/’，所以以此区分\nif($filename[strlen($filename)-1]!=&#39;/&#39;)\n{\ncopy(&#39;zip://&#39;.$files[&#39;tmp_name&#39;].&#39;#&#39;.$filename,$filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;].&#39;/&#39;.$fileinfo[&#39;basename&#39;]);\n//如是文件，将其复制到临时目录\n}\n}\n$zip-&gt;close();//关闭压缩文件\nreturn&nbsp;$filepath;\n}\n}\nreturn&nbsp;null;\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"><br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><hr/><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">解压后就是与旧文件对比替换了，思路就是获取文件夹目录中的所有文件和目录，如是目录，递归处理，如是文件，先判断其与旧文件的修改时间是否相同，相同就说明文件没有修改过，不用替换，如不相同，再比较两个文件的哈希散列值，如相同，说明文件内容没有改动，不用替换。否则，替换。当然，如果无相应旧文件，也要进行复制操作。代码如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;files_replace($frompath,$topath)\n{\nif(!file_exists($topath))\n{\nmkdir($topath);\n}\n$files&nbsp;=&nbsp;scandir($frompath);//获取指定目录下的所有文件和目录数组\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)//因为获取的信息有上级目录‘..’和当前目录‘.’，不需处理，直接略过\n{\ncontinue;\n}\nif(is_dir($frompath.&#39;/&#39;.$files[$i]))//如是目录，递归处理\n{\nfiles_replace($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\n$needtoreplace&nbsp;=&nbsp;true;//标记文件是否需要复制，默认置为需要\nif(file_exists($topath.&#39;/&#39;.$files[$i]))//判断旧文件是否存在相应文件\n{\nif(filemtime($frompath.&#39;/&#39;.$files[$i])&nbsp;==&nbsp;filemtime($topath.&#39;/&#39;.$files[$i]))//判断两个文件修改时间是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\nelse\n{\n$oldfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$frompath.&#39;/&#39;.$files[$i]);\n$newfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$topath.&#39;/&#39;.$files[$i]);\nif($oldfilehash&nbsp;==&nbsp;$newfilehash)//判断两个文件哈希散列值是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\n}\n}\nif($needtoreplace)\n{\ncopy($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);//将新文件拷贝到对应位置\necho(&#39;replacefile:&#39;.$topath.&#39;/&#39;.$files[$i].&quot;&lt;br/&gt;&quot;);\n}\n}\n}\n}</pre><p><br/></p><hr/><p><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">最后就是删除临时的解压文件了，由于没有直接的删除非空目录的方法，采用循环加递归的方法级联删除所有文件，实现</span><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;delete_files($filepath)\n{\n$files&nbsp;=&nbsp;scandir($filepath);\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)\n{\ncontinue;\n}\nif(is_dir($filepath.&#39;/&#39;.$files[$i]))\n{\ndelete_files($filepath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\nunlink($filepath.&#39;/&#39;.$files[$i]);\n}\n}\nrmdir($filepath);\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">完整的程序在我的github上：</span><a href=\"https://github.com/Taurus-uomini/files_replace\" target=\"_self\">https://github.com/Taurus-uomini/files_replace</a></p>', 16, '文件上传对比替换', '2018-06-07 13:50:45', '2018-07-04 01:58:22');

-- --------------------------------------------------------

--
-- 表的结构 `t_blogger`
--

CREATE TABLE `t_blogger` (
  `id` int(11) NOT NULL COMMENT '博主id',
  `userName` varchar(50) DEFAULT NULL COMMENT '用户名',
  `password` varchar(100) DEFAULT NULL COMMENT '密码',
  `profile` text COMMENT '个人简介',
  `nickName` varchar(50) DEFAULT NULL COMMENT '昵称',
  `sign` varchar(100) DEFAULT NULL COMMENT '签名',
  `imageName` varchar(100) DEFAULT NULL COMMENT '头像',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `t_blogger`
--

INSERT INTO `t_blogger` (`id`, `userName`, `password`, `profile`, `nickName`, `sign`, `imageName`, `create_time`, `update_time`) VALUES
(1, 'JLoongKing', 'b97183ee6e875d4a64de6e15870bf3dd', '<p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">白衣裳凭朱栏立</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">凉月趖西</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">点鬓霜微</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">岁晏知君归不归</span><br/><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">残更目断传书雁</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">尺素还稀</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">一味相思</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">准拟相看似旧时</span></p><p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\"><br/></span></p><p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\"><br/></span></p><p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\"></span></p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">《贺新郎·甚矣吾衰矣》</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">【宋】辛弃疾</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">甚矣吾衰矣。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">怅平生、交游零落，只今馀几！</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">白发空垂三千丈，一笑人间万事。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">问何物、能令公喜？</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">我见青山多妩媚，料青山见我应如是。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">情与貌，略相似。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">一尊搔首东窗里。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">想渊明《停云》诗就，此时风味。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">江左沉酣求名者，岂识浊醪妙理。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">回首叫、云飞风起。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">知我者，二三子。</p><p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\"><br/></span><br/></p>', '王霄', '<p>老当益壮，宁移白首之心。穷且益坚，不坠青云之志。</p>', '/tp50/public/Uploads/20180623/5b2d97e335b87.jpg', NULL, '2018-06-29 04:17:23');

-- --------------------------------------------------------

--
-- 表的结构 `t_blogtype`
--

CREATE TABLE `t_blogtype` (
  `id` int(11) NOT NULL COMMENT '标签id',
  `typeName` varchar(30) DEFAULT NULL COMMENT '标签名',
  `orderNo` int(11) DEFAULT NULL COMMENT '优先级',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `t_blogtype`
--

INSERT INTO `t_blogtype` (`id`, `typeName`, `orderNo`, `create_time`, `update_time`) VALUES
(2, 'Mysql', 2, NULL, NULL),
(4, 'IT之路', 6, NULL, NULL),
(5, '随心生活', 7, NULL, NULL),
(13, '西游重生井龙王', 1, NULL, NULL),
(15, 'thinkphp', 10, '2018-05-30 09:26:02', '2018-05-30 09:26:02'),
(16, 'php', 0, '2018-06-07 13:51:09', '2018-06-07 13:51:09');

-- --------------------------------------------------------

--
-- 表的结构 `t_color`
--

CREATE TABLE `t_color` (
  `id` int(11) NOT NULL COMMENT '主题id',
  `colorname` varchar(100) NOT NULL COMMENT '主题名',
  `active` int(11) NOT NULL COMMENT '是否选定0否/1是'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `t_color`
--

INSERT INTO `t_color` (`id`, `colorname`, `active`) VALUES
(1, '天空蓝', 1),
(2, '日出橙', 1);

-- --------------------------------------------------------

--
-- 表的结构 `t_comment`
--

CREATE TABLE `t_comment` (
  `id` int(11) NOT NULL COMMENT '评论id',
  `userName` varchar(50) DEFAULT NULL COMMENT '用户ip',
  `blogId` int(11) DEFAULT NULL COMMENT '博客id',
  `content` varchar(1000) DEFAULT NULL COMMENT '内容',
  `status` int(11) DEFAULT NULL COMMENT '状态',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  `toid` int(11) DEFAULT NULL COMMENT '回复评论的id'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `t_comment`
--

INSERT INTO `t_comment` (`id`, `userName`, `blogId`, `content`, `status`, `create_time`, `update_time`, `toid`) VALUES
(14, 'JLoongKing', 79, '写的不错', 0, '2018-05-29 02:15:54', '2018-06-07 09:40:44', 0),
(16, '流星—一逝光阴', 94, '<p>test</p>', 0, '2018-06-22 09:43:49', '2018-06-22 09:43:49', 0),
(17, '流星—一逝光阴', 94, '<p>aa</p>', 0, '2018-06-22 09:49:19', '2018-06-22 09:49:19', 0),
(18, '＊Purity teen＊', 90, '<p>犹太人同一人</p>', 0, '2018-06-22 15:21:36', '2018-06-22 15:21:36', 0);

-- --------------------------------------------------------

--
-- 表的结构 `t_link`
--

CREATE TABLE `t_link` (
  `id` int(11) NOT NULL COMMENT '链接id',
  `linkName` varchar(100) DEFAULT NULL COMMENT '连接名',
  `linkUrl` varchar(200) DEFAULT NULL COMMENT '链接url',
  `orderNo` int(11) DEFAULT NULL COMMENT '优先级',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `t_link`
--

INSERT INTO `t_link` (`id`, `linkName`, `linkUrl`, `orderNo`, `create_time`, `update_time`) VALUES
(6, '百度引擎', 'https://www.baidu.com', 1, NULL, NULL),
(7, 'google', 'https://www.google.com', 2, NULL, NULL),
(8, '必应', 'http://cn.bing.com', 3, NULL, NULL),
(10, '蒋振飞的博客', 'http://www.jzfblog.top', 1, '2018-07-03 08:38:33', '2018-07-03 08:38:33');

-- --------------------------------------------------------

--
-- 表的结构 `t_log`
--

CREATE TABLE `t_log` (
  `id` int(11) NOT NULL COMMENT '管理员日志id',
  `adminname` varchar(100) NOT NULL COMMENT '管理员名称',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `loginfo` text NOT NULL COMMENT '日志信息'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `t_log`
--

INSERT INTO `t_log` (`id`, `adminname`, `create_time`, `loginfo`) VALUES
(7, 'Admin', '2018-05-29 01:40:19', '从t_blog修改字段名为id值为72的数据，修改为第一章  初入  13 <p>&nbsp; &nbsp; 西牛贺洲地域之大，南北东西各有万里之遥，百里之地即可称邦号国，大小城邦不计其数。乌鸡国地处西南一隅，方圆十多万平方公里，相比那东土神国，就连一州之地都相差甚远。但是在西域之地，却也是极为强大的国邦。周围小国年年进贡，岁岁来朝。乌鸡国祖先连年征战打下一片疆土，之后十几界国王倒也算得上贤明有德。当今圣上轻摇赋税，臣子治民有方，百姓安居乐业，时值春社已近，百姓们都放下手中的活，享受难得的休息。</p><p>城中大小商铺林立，热闹非凡，一家酒馆看似不大，但里面确是极为吵杂，宾客与小二来往不断，人们的吵闹声音不绝于耳。</p><p>“今年的天气有点特殊不知道你们看出来了吗，我总觉得这不是一件好事情”一位看上去文质彬彬的读书人为自己斟了一小杯酒，小小的抿了一口对着大家说道。</p><p>他一双眼睛瞄了瞄同一桌上的其他人，见都被他的话吸引，一言不发，等着他的下文，他心里很满意，就晃了晃酒杯，想了想继续说道：“我们乌鸡国本就地处南方，春夏秋冬固然分的仔细不过，但是由于我们地处南方，相对的也就一年四季比北方要暖和一些，但是今年却不知怎么回事，却是格外的寒冷”</p><p>&nbsp; &nbsp;“听你这么一说好像确实是这样呢”</p><p>“嗯，今年天气实在怪异，冷的出奇却没下过一场雪！”</p><p>“我听我爷爷说乌鸡国已经有近60年没有这种天气了”</p><p><span style=\"white-space:pre\">	</span>“哎，你们听说了吗，听说今年皇宫里不太平”一个满脸奸猾之象的年轻人喝了一口酒乍了乍舌接着说道，“你们说今年天气和这有关系吗？”。</p><p><span style=\"white-space:pre\">	</span>“哦，怎么不太平？”众人被勾起了好奇心。</p><p>他又抿了一口酒，慢慢的吧唧吧唧嘴“好酒”。</p><p>“你小子别光喝酒，倒是说啊”</p><p><span style=\"white-space:pre\">	</span>“嘿嘿，别急嘛！就是我有一个亲戚在宫里当差，他说他看到过御花园里的一口八宝琉璃井在夜里发光。你们说是不是有鬼魂作祟。”</p><p><span style=\"white-space:pre\">	</span>“其实你这也并不稀奇，皇宫吗？ 很容易有这种情况的，说不定就是哪个宫女投井后的鬼魂呢”大伙猜测说。</p><p><span style=\"white-space:pre\">	</span>“对对，含冤而死导致天象有异有可能！”有人和之前的事情联系了起来，众人纷纷点头。</p><p>“别瞎说，哪个鬼魂能有这个本事，还改变天象！，更何况当今皇上还是挺圣明的，大家伙啊莫谈国事”掌柜子插嘴道“今天天气冷，给几位也多加了个煮豆腐，来，都尝尝！”</p><p>“对对，莫谈国事！嘿嘿！”众人笑道。</p><p>&nbsp;乌鸡国王宫处于整个乌鸡国城邦的中心位置，皇宫修在了一条活水的两边，建筑阁楼气势磅礴，虽然已经过了不知多少年的沉淀，但是却还有这那种朝气蓬勃之感。</p><p>乌鸡国传承至今已过十余代，经过积累，已将王宫修建的美轮美奂，御花园中有一口八角琉璃井，此时那井中井水翻腾不止，在其中现一龙形，这龙苍如劲松，身下云气翻涌，如若将入长空，又似急渊入海，这龙似云气缩聚，又有钟灵之气缠绕而上，龙形的身体俞稳，云气缓缓消失不见，只见那龙摇身一晃变作一青年，那青年相貌不凡，头戴金冠，身着紫色的锦袍绣衣，腰间有一金线织成的明黄金丝带，足踏青云疾风履，有一种独有的气质萦绕其身。青年眼睛缓缓睁开，眼中有所明悟。</p><p>正是大地初开，阴阳交互，形成了天地之间的第一缕和泰之气，又有成百上千年的积累，得大地钟灵汇集逐渐而成，今日方得孕育而出，出生即可翻云覆雨，当是金仙之境。</p><p><span style=\"white-space:pre\">	</span>青年长身而起“以后我就叫季逸云吧！前尘以往皆为灰烬。”前尘如梦，其实季逸云也分不清到底是什么前世生活到底是真实还是一场梦。上一秒钟还在电脑旁，这一秒就来到了这个世界。想到井龙王在西游世界里简直就是一个打酱油的存在，季逸云不由得苦笑，井龙王其实根骨奇高，想那猴子他就是一颗石头经过天地精气雕琢就能有那样的成就，而井龙王可是天地初开的第一缕和泰之气而成，未来成就不可限量，说起来他和天生地长的都算是兄弟姐妹呢，季逸云的苦笑不由得又加重了一些。不过呢当前的任务是变强，这一点季逸云还是知道的，他可不想在默默无闻一辈子，想了想，季逸云消失在原地。</p><p>季逸云来到了乌鸡国城中的闹市，他是金仙境界，想来闯荡江湖不成问题。他走在热闹的大街上，乌鸡国不愧为强盛的城邦，大街上人来人往，摩肩接踵，异常的热闹突然看到一家酒馆，酒馆并没什么不同但是它的牌子很新奇上面就有一个字“御”，但是旁边立了一个木桩挂着一面旗帜，上书“云海翻滚处，机缘莫强求”。</p><p>&nbsp; &nbsp; 怪人怪事还真是多，季逸云略微诧异，但也没多想摇了摇头就想继续走了解一下这西游世界的风土人情。</p><p>&nbsp; &nbsp; “嗨，兄弟，你是在想招牌的事吗”这时一个满面通红的少年走了上来，一看就是喝多了那种，一步一个踉跄，上来勾住季逸云的肩膀就问道，季逸云眉头略微一皱。&nbsp;</p><p>&nbsp; &nbsp; “对啊！”季逸云下意识答到。</p><p>&nbsp; &nbsp; “想知道吗？想知道的话。。。。”&nbsp;</p><p>&nbsp; &nbsp; 他的眼神向里面瞟了瞟，样子一下变得好贱，满脸奸笑道“嗯。。嗯。。，有点渴了”。</p><p>&nbsp; &nbsp; 季逸云顿时明白了，想喝酒了啊，心中好笑。</p><p>&nbsp; &nbsp; “哦。。哦，兄弟，里面请！走咱们喝两杯。”季逸云推开他的胳膊当先向里面走去。</p><p>&nbsp; &nbsp; 酒馆里面倒也和平常没什么两样，就是简朴的有些过头了，除了桌椅再无它物，虽然有一种很古老的感觉，但偏偏一眼看去都是新的，“难道乌鸡国还流行古典美。。。”季逸云心中有种很古怪的感觉。进到里边，找了个贴着窗户的座位坐下了。</p><p>&nbsp; &nbsp; “小二，来几斤上好的女儿红”少年当先叫道。</p><p>&nbsp; &nbsp; “客官，几斤啊”小二笑道。</p><p>&nbsp; &nbsp; “你说呢，就是老规矩”少年反应过来斜了个白眼。</p><p>&nbsp; &nbsp; “嘿嘿，明白！乙二桌两斤女儿红！”季逸云心想“得，这家伙还是常客，果然被坑了！”</p><p>&nbsp; &nbsp; “兄台怎么称呼？”</p><p>&nbsp; &nbsp; “在下季逸云，你唤我季兄或者云哥儿都行”季逸云客气到。</p><p>&nbsp; &nbsp; “在下欧阳，姓欧，名阳，非是复姓欧阳”。</p><p>&nbsp; &nbsp; “哦哦，欧兄”季逸云很想翻一个白眼，这个家伙到底被误会了多少次，这么深刻，还非得解释一下。</p><p>&nbsp; &nbsp; &nbsp;欧阳不好意思的笑了笑就继续往下说“要说这酒楼为何有个‘御’字匾这可说来话长了，兄台你不是本地人吧，本地人都知道这个的匾来历”他也没停顿露出一副你肯定不是本地人的架势道“话说很久很久很久。。。以前”见他还要“很久”下去，季逸云瞪了一眼“说重点”。这时酒端了上来“客官，慢用！”。</p><p>&nbsp; &nbsp; “额，大概200多年前这里就已经是乌鸡城中比较有名的酒馆了，三教九流就没有没来过的，本来再长的就干也没有道理长时间红火下去，由于当时经济灾荒的关系酒馆里人越来越少，这东西就这样太平年岁百姓家里有的是闲钱，每天都有人花钱找乐子，但到了当时几乎吃饱饭都是个问题，你说谁能来这酒馆啊！”，季逸云听到这里点了点头道“也是，宁为太平狗，不做乱世人！”。</p><p>“兄台，你这句话精辟啊！当时几乎没几个人去酒馆，但是有一天来了一位老道士。这老道士可是一位了不得的人物！”说到这里欧阳停了停，喝了口酒喳了喳。</p><p>“哦，怎么了不得？”季逸云被勾起了兴趣。</p><p>“他是一位神仙。”</p><p>“哦，怎么个神仙法？”随即又暗想道“我还是一位神仙呢！”。</p><p>“他来时和普通的游方道士没什么两样，风尘仆仆，听说道袍上还缝着几个补丁。当时老板和老板娘是一对老夫妻人也很善良，生意不好做，但是靠着百年老店的招牌还不至于开不下去，他们看到老道人单衣薄再加上拿不出饭钱，就发了善心免了道人的饭钱。这老道临走之前就留下了一句话和一块匾，然后他又对那老夫妻说’你们积德行善百年后该当升仙得道。‘ ，而那块匾就是‘御’字匾，那话就是外面旗帜上那句话。那对夫妻果然长寿百岁，去时有白鹤接迎，而那匾挂到如今依然光亮如新，人多说‘御’字中是有机缘的。”</p><p><br/></p><p><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp;</p>     西牛贺洲地域之大，南北东西各有万里之遥，百里之地即可称邦号国，大小城邦不计其数。乌鸡国地处西南一隅，方圆十多万平方公里，相比那东土神国，就连一州之地都相差甚远。但是在西域之地，却也是极为强大的国邦。周围小国年年进贡，岁岁来朝。乌鸡国祖先连年征战打下一片疆土，之后十几界国王倒也算得上贤明有德。当今圣上轻'),
(8, 'Admin', '2018-05-29 01:57:14', '从t_comment删除字段名为id值为5的数据'),
(9, 'Admin', '2018-05-29 01:57:23', '从t_comment删除字段名为id值为6的数据'),
(10, 'Admin', '2018-05-29 01:57:26', '从t_comment删除字段名为id值为7的数据'),
(11, 'Admin', '2018-05-29 01:57:29', '从t_comment删除字段名为id值为8的数据'),
(12, 'Admin', '2018-05-29 01:57:31', '从t_comment删除字段名为id值为9的数据'),
(13, 'Admin', '2018-05-29 01:57:34', '从t_comment删除字段名为id值为10的数据'),
(14, 'Admin', '2018-05-29 01:57:37', '从t_comment删除字段名为id值为11的数据'),
(15, 'Admin', '2018-05-29 01:57:39', '从t_comment删除字段名为id值为12的数据'),
(16, 'Admin', '2018-05-29 01:57:42', '从t_comment删除字段名为id值为13的数据'),
(17, 'Admin', '2018-05-30 09:16:32', '从t_blog删除字段名为id值为92的数据'),
(18, 'Admin', '2018-05-30 09:20:06', '从t_blogtype删除字段名为id值为14的数据'),
(19, 'Admin', '2018-05-30 09:20:26', '从t_blogtype删除字段名为id值为3的数据'),
(20, 'Admin', '2018-05-30 09:23:02', '从t_blogtype删除字段名为id值为1的数据'),
(21, 'Admin', '2018-05-30 09:26:02', '向t_blogtype添加thinkphp 10'),
(22, 'Admin', '2018-05-30 09:49:40', '向t_blog添加thinkphp5部署workerman长连接 tp5 thinkphp workerman 长连接  15 <p style=\"text-indent: 2em;\">由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman，在之前我曾经利用workerman进行聊天软件的编写，实现多人在线聊天功能，而在这之前我没有将这个博客编写成功，本次趁着这个机会，我将长连接的知识进行了复习，正好博客完成时间没有多久，于是将这次经历记录在案，以备以后自己查看学习，也方便了，看到这个博文并且可能需要用到该框架的同学们。</p><p style=\"text-indent: 2em;\">在进行该教程之前，我们需要了解一下workerman这个框架和thinkphp这个框架，thinkphp框架是PHP几大框架之一，想要了解的同学们可以到<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\">ThinkPHP5.0完全开发手册</a>上进行文档的阅读，以下简称tp5，tp5框架是国产为数不多的优秀框架之一，国产的哦！<img src=\"http://img.baidu.com/hi/jx2/j_0007.gif\"/>而workerman则是在<a href=\"http://www.workerman.net/\" target=\"_self\" title=\"workerman\">workerman</a>官网上有详细的介绍，同学们可以到该网站上进行手册的查看。</p><p style=\"text-indent: 2em;\">未完待续。。。。。</p><p><br/></p> 由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman 0 0'),
(23, 'Admin', '2018-05-31 02:27:13', '从t_blog修改字段名为id值为93的数据，修改为thinkphp5部署workerman长连接  2 <p style=\"text-indent: 2em; line-height: 2em;\">由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman，在之前我曾经利用workerman进行聊天软件的编写，实现多人在线聊天功能，而在这之前我没有将这个博客编写成功，本次趁着这个机会，我将长连接的知识进行了复习，正好博客完成时间没有多久，于是将这次经历记录在案，以备以后自己查看学习，也方便了看到这个博文并且可能需要用到该框架的同学们。最后，<span style=\"text-indent: 32px;\">我需要感谢一位同学，他在这个项目中帮助了我很多，</span>。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在进行该教程之前，我们需要了解一下workerman这个框架和thinkphp这个框架，thinkphp框架是PHP几大框架之一，想要了解的同学们可以到<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\">ThinkPHP5.0完全开发手册</a>上进行文档的阅读，以下简称tp5，tp5框架是国产为数不多的优秀框架之一，国产的哦！<img src=\"http://img.baidu.com/hi/jx2/j_0007.gif\"/>而workerman则是在<a href=\"http://www.workerman.net/\" target=\"_self\" title=\"workerman\">workerman</a>官网上有详细的介绍，同学们可以到该网站上进行手册的查看。</p><p style=\"text-indent: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\" style=\"text-indent: 32px; white-space: normal;\">ThinkPHP5.0完全开发手册</a>里面有一篇介绍他们两个融合的文章<a href=\"https://www.kancloud.cn/manual/thinkphp5/235128\" target=\"_blank\" title=\"composer包workerman\">composer包workerman</a>在这篇文章里介绍了tp5融合workerman的教程，但是介绍的过于简洁，我试验了两次并没有走通，而在这次的记录中我将我的融合过程和这个方法进行对比，分析以前没有走通的原因。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em;\">不论在哪个方法中，我们都需要将wokerman的包引入，我们需要用到composer，没有安装composer的同学需要自行安装。</p><p style=\"text-indent: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第一步</h1><p><br/></p><p style=\"text-indent: 2em;\"><span style=\"text-indent: 2em;\">导入workerman包：</span></p><pre class=\"brush:html;toolbar:false;\">composer&nbsp;require&nbsp;topthink/think-worker</pre><p style=\"text-indent: 2em;\">&nbsp;如果<span style=\"color: rgb(255, 0, 0);\">windows服务器</span>还要利用以下命令：<br/></p><pre class=\"brush:bash;toolbar:false\">composer&nbsp;require&nbsp;workerman/workerman-for-win</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">如</span><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">运行出现错误PHP Fatal error: Call to undefined function Workerman\\Lib\\pcntl_signal()，需要删除vendor\\workerman\\workerman，防止命名覆盖。</span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">当包引入完成后，我们会在项目根目录下的vendor文件夹下看到workerman文件夹，这样框架就引入了该项目，我们下一步需要配置服务的启动和引用。</span><br/></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\"><br/></span></span></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第二步</h1><p><br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">在这一步中我们需要将启动服务文件放入到项目根目录中，在根目录中我们新建启动服务文件server.php<br/></span></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\">代码如下：</span></span></p><pre class=\"brush:php;toolbar:false\">#!/usr/bin/env&nbsp;php\n&lt;?php\ndefine(&#39;APP_PATH&#39;,&nbsp;__DIR__&nbsp;.&nbsp;&#39;/application/&#39;);\n//这是原来的代码\n//define(&#39;BIND_MODULE&#39;,&#39;push/Worker&#39;);\n//这是我修改后的代码\ndefine(&#39;BIND_MODULE&#39;,&#39;push/Workertest/index&#39;);\n//&nbsp;加载框架引导文件\nrequire&nbsp;__DIR__&nbsp;.&nbsp;&#39;/thinkphp/start.php&#39;;</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\"></span></span>这个代码的意思是绑定workerman的模块是/application/push/Worker这个控制器，但是由于我们没有用tp5这个框架的引用方式这里我们将代码改为如上所示，直接进入到控制器的index方法，在下一步我们会介绍为什么用这种方法。我们在下一步中就会定义模块，也就是实现功能的地方：/application/push/workertest.php<br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第三步</h1><p><span style=\"color: rgb(255, 0, 0);\">在这一步开始前我们来看一下tp5开发手册中的worker.php，需要声明的是我并没用利用该方法。</span></p><p style=\"line-height: 2em; text-indent: 2em;\">&nbsp;&nbsp;&nbsp;&nbsp;一共有一个变量和5个方法，变量是定义端口和域名的，方法是分别为，连接上时，服务开始时，接到信息时，错误时，断开时的相应处理方法。</p><p>代码如下</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;think\\worker\\Server;\nclass&nbsp;Worker&nbsp;extends&nbsp;Server{&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;$socket&nbsp;=&nbsp;&#39;websocket://push.app:2346&#39;;&nbsp;&nbsp;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;收到信息\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$data\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onMessage($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&#39;我收到你的信息了&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接建立时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onConnect($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接断开时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onClose($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当客户端的连接上发生错误时触发\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$code\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$msg\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onError($connection,&nbsp;$code,&nbsp;$msg)\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;error&nbsp;$code&nbsp;$msg\\n&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;每个进程启动\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$worker\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onWorkerStart($worker)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"text-indent: 2em; line-height: 2em;\">如果用tp5给出的方法，我们需要在其他的控制器中实例化该控制器类，而在我用到该框架时没有看出该用法，误以为实现功能直接在该控制器中调用即可，当我利用到tcp链接时出现了两个链接的同时调用，在tp5文档中的这个方法，我无法同时实例化两个链接，于是我放弃了该方法，想要研究的同学可以继续研究一下，下面给出我的方法。</p><p>workertest.php代码如下：</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;Workerman\\Worker;\nuse&nbsp;Workerman\\Lib\\Timer;\nuse&nbsp;Workerman\\Connection\\AsyncTcpConnection;\nclass&nbsp;WorkerTest\n{\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connections;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connection_to_ws;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index()\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$connections&nbsp;=&nbsp;array();&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket&nbsp;=&nbsp;new&nbsp;Worker(&#39;websocket://0.0.0.0:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;设置transport开启ssl，websocket+ssl即wss\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$socket-&gt;transport&nbsp;=&nbsp;&#39;ssl&#39;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;启动1个进程对外提供服务&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;count&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//给这个进程设置一个array（）\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onConnect&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;lianjie&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onMessage&nbsp;=&nbsp;function($connection,$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(json_decode($data));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$jdata&nbsp;=&nbsp;json_decode($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($jdata-&gt;tem))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($con-&gt;endno)&amp;&amp;isset($jdata-&gt;endno)&amp;&amp;$con-&gt;endno==$jdata-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send($jdata-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;数据已接受&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;endno=$jdata-&gt;endno;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接断开时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onClose&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($connection-&gt;id))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;连接断开时删除映射\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset($this-&gt;connections[$connection-&gt;id]);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp&nbsp;=&nbsp;new&nbsp;Worker(&#39;tcp://0.0.0.0:8282&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp-&gt;onMessage&nbsp;=&nbsp;function($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_null($this-&gt;connection_to_ws))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(&#39;connect&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws&nbsp;=&nbsp;new&nbsp;AsyncTcpConnection(&#39;ws://119.29.170.92:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;connect();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;send($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($con-&gt;endno==json_decode($data)-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send(json_decode($data)-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;运行worker&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worker::runAll();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"line-height: 2em; text-indent: 2em;\">每当前端浏览器通过websoket上传给服务器对应终端号，workerman就会将本链接放入到队列，与此同时，我通过tcp获取到硬件的值，并经过AsyncTcpConnection这个workerman对象将由tcp端口获取的值转发给websoket端口，再由websoket进行遍历当前队列链接的前端浏览器，通过终端id查找并推送给对应的前端浏览器。<br/></p><p><br/></p> 由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman'),
(24, 'Admin', '2018-06-07 08:23:35', '从t_blog修改字段名为id值为90的数据，修改为第一篇博文  2 <p style=\"line-height: 1.5em; text-align: left; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\">这个博客在2018年4月</span><span style=\"text-indent: 2em; font-size: 20px;\"></span><span style=\"font-size: 18px; text-indent: 2em;\">完成了，写这篇博文的时候是博客刚刚完成了后台功能，前台界面我还没有写，但是我抑制不住自己写这篇博客的欲望。在大学四年跌跌撞撞也算是做了人生旅途这一阶段的路程吧，我一直相信人生的每一段旅途应该完成的事情是不同的，而我的大学生涯过的并不算很华丽，但是确让我感到清晰和完整。人们都说大学生涯应该是轻松和快乐的，对于这件事我深以为然，追一下自己喜欢的姑娘，干一些自己喜欢的事情，或者交上一大群同样不求上进的朋友。大学时间过的真是快，一不小心自己就临近毕业，工作当然很辛苦，但是人生不可缺少的一部分。最后以此文章证明我大学生涯的结束和这个博客的起始。</span><br/></p><p style=\"line-height: 1.5em; text-align: center; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\"><img src=\"/tp50/public/upload/image/20180418/1524041983.jpg\" title=\"1524041983.jpg\" alt=\"9f3d80e7e814a80588434bda4c2a6843.jpg\" width=\"611\" height=\"300\"/></span></p> 这是这个网站的第一篇博文，一直都想做一个自己的博客，但我这个人相对较懒，没有缘由，我可能一辈子都完不成这个任务。这次借着做毕业设计的机会，刚好完成想了几年也没动手去做的事情。'),
(25, 'Admin', '2018-06-07 08:54:28', '从t_blog修改字段名为id值为90的数据，修改为第一篇博文  2 <p style=\"line-height: 1.5em; text-align: left; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\">这个博客在2018年4月</span><span style=\"text-indent: 2em; font-size: 20px;\"></span><span style=\"font-size: 18px; text-indent: 2em;\">完成了，写这篇博文的时候是博客刚刚完成了后台功能，前台界面我还没有写，但是我抑制不住自己写这篇博客的欲望。在大学四年跌跌撞撞也算是做了人生旅途这一阶段的路程吧，我一直相信人生的每一段旅途应该完成的事情是不同的，而我的大学生涯过的并不算很华丽，但是确让我感到清晰和完整。人们都说大学生涯应该是轻松和快乐的，对于这件事我深以为然，追一下自己喜欢的姑娘，干一些自己喜欢的事情，或者交上一大群同样不求上进的朋友。大学时间过的真是快，一不小心自己就临近毕业，工作当然很辛苦，但是人生不可缺少的一部分。最后以此文章证明我大学生涯的结束和这个博客的起始。</span><br/></p><p style=\"line-height: 1.5em; text-align: center; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\"><img src=\"/tp50/public/upload/image/20180418/1524041983.jpg\" title=\"1524041983.jpg\" alt=\"9f3d80e7e814a80588434bda4c2a6843.jpg\" width=\"611\" height=\"300\"/></span></p> 这是这个网站的第一篇博文，一直都想做一个自己的博客，但我这个人相对较懒，没有缘由，我可能一辈子都完不成这个任务。这次借着做毕业设计的机会，刚好完成想了几年也没动手去做的事情。'),
(26, 'Admin', '2018-06-07 08:59:18', '从t_blog修改字段名为id值为90的数据，修改为第一篇博文   2 <p style=\"line-height: 1.5em; text-align: left; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\">这个博客在2018年4月</span><span style=\"text-indent: 2em; font-size: 20px;\"></span><span style=\"font-size: 18px; text-indent: 2em;\">完成了，写这篇博文的时候是博客刚刚完成了后台功能，前台界面我还没有写，但是我抑制不住自己写这篇博客的欲望。在大学四年跌跌撞撞也算是做了人生旅途这一阶段的路程吧，我一直相信人生的每一段旅途应该完成的事情是不同的，而我的大学生涯过的并不算很华丽，但是确让我感到清晰和完整。人们都说大学生涯应该是轻松和快乐的，对于这件事我深以为然，追一下自己喜欢的姑娘，干一些自己喜欢的事情，或者交上一大群同样不求上进的朋友。大学时间过的真是快，一不小心自己就临近毕业，工作当然很辛苦，但是人生不可缺少的一部分。最后以此文章证明我大学生涯的结束和这个博客的起始。</span><br/></p><p style=\"line-height: 1.5em; text-align: center; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\"><img src=\"/tp50/public/upload/image/20180418/1524041983.jpg\" title=\"1524041983.jpg\" alt=\"9f3d80e7e814a80588434bda4c2a6843.jpg\" width=\"611\" height=\"300\"/></span></p> 这是这个网站的第一篇博文，一直都想做一个自己的博客，但我这个人相对较懒，没有缘由，我可能一辈子都完不成这个任务。这次借着做毕业设计的机会，刚好完成想了几年也没动手去做的事情。'),
(27, 'Admin', '2018-06-07 09:00:18', '从t_blog修改字段名为id值为90的数据，修改为第一篇博文   2 <p style=\"line-height: 1.5em; text-align: left; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\">这个博客在2018年4月</span><span style=\"text-indent: 2em; font-size: 20px;\"></span><span style=\"font-size: 18px; text-indent: 2em;\">完成了，写这篇博文的时候是博客刚刚完成了后台功能，前台界面我还没有写，但是我抑制不住自己写这篇博客的欲望。在大学四年跌跌撞撞也算是做了人生旅途这一阶段的路程吧，我一直相信人生的每一段旅途应该完成的事情是不同的，而我的大学生涯过的并不算很华丽，但是确让我感到清晰和完整。人们都说大学生涯应该是轻松和快乐的，对于这件事我深以为然，追一下自己喜欢的姑娘，干一些自己喜欢的事情，或者交上一大群同样不求上进的朋友。大学时间过的真是快，一不小心自己就临近毕业，工作当然很辛苦，但是人生不可缺少的一部分。最后以此文章证明我大学生涯的结束和这个博客的起始。</span><br/></p><p style=\"line-height: 1.5em; text-align: center; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\"><img src=\"/tp50/public/upload/image/20180418/1524041983.jpg\" title=\"1524041983.jpg\" alt=\"9f3d80e7e814a80588434bda4c2a6843.jpg\" width=\"611\" height=\"300\"/></span></p> 这是这个网站的第一篇博文，一直都想做一个自己的博客，但我这个人相对较懒，没有缘由，我可能一辈子都完不成这个任务。这次借着做毕业设计的机会，刚好完成想了几年也没动手去做的事情。'),
(28, 'Admin', '2018-06-07 09:00:29', '从t_blog修改字段名为id值为90的数据，修改为第一篇博文   2 <p style=\"line-height: 1.5em; text-align: left; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\">这个博客在2018年4月</span><span style=\"text-indent: 2em; font-size: 20px;\"></span><span style=\"font-size: 18px; text-indent: 2em;\">完成了，写这篇博文的时候是博客刚刚完成了后台功能，前台界面我还没有写，但是我抑制不住自己写这篇博客的欲望。在大学四年跌跌撞撞也算是做了人生旅途这一阶段的路程吧，我一直相信人生的每一段旅途应该完成的事情是不同的，而我的大学生涯过的并不算很华丽，但是确让我感到清晰和完整。人们都说大学生涯应该是轻松和快乐的，对于这件事我深以为然，追一下自己喜欢的姑娘，干一些自己喜欢的事情，或者交上一大群同样不求上进的朋友。大学时间过的真是快，一不小心自己就临近毕业，工作当然很辛苦，但是人生不可缺少的一部分。最后以此文章证明我大学生涯的结束和这个博客的起始。</span><br/></p><p style=\"line-height: 1.5em; text-align: center; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\"><img src=\"/tp50/public/upload/image/20180418/1524041983.jpg\" title=\"1524041983.jpg\" alt=\"9f3d80e7e814a80588434bda4c2a6843.jpg\" width=\"611\" height=\"300\"/></span></p> 这是这个网站的第一篇博文，一直都想做一个自己的博客，但我这个人相对较懒，没有缘由，我可能一辈子都完不成这个任务。这次借着做毕业设计的机会，刚好完成想了几年也没动手去做的事情。'),
(29, 'Admin', '2018-06-07 09:16:32', '从t_blog修改字段名为id值为93的数据，修改为thinkphp5部署workerman长连接   2 <p style=\"text-indent: 2em; line-height: 2em;\">由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman，在之前我曾经利用workerman进行聊天软件的编写，实现多人在线聊天功能，而在这之前我没有将这个博客编写成功，本次趁着这个机会，我将长连接的知识进行了复习，正好博客完成时间没有多久，于是将这次经历记录在案，以备以后自己查看学习，也方便了看到这个博文并且可能需要用到该框架的同学们。最后，<span style=\"text-indent: 32px;\">我需要感谢一位同学，他在这个项目中帮助了我很多，</span>。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在进行该教程之前，我们需要了解一下workerman这个框架和thinkphp这个框架，thinkphp框架是PHP几大框架之一，想要了解的同学们可以到<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\">ThinkPHP5.0完全开发手册</a>上进行文档的阅读，以下简称tp5，tp5框架是国产为数不多的优秀框架之一，国产的哦！<img src=\"http://img.baidu.com/hi/jx2/j_0007.gif\"/>而workerman则是在<a href=\"http://www.workerman.net/\" target=\"_self\" title=\"workerman\">workerman</a>官网上有详细的介绍，同学们可以到该网站上进行手册的查看。</p><p style=\"text-indent: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\" style=\"text-indent: 32px; white-space: normal;\">ThinkPHP5.0完全开发手册</a>里面有一篇介绍他们两个融合的文章<a href=\"https://www.kancloud.cn/manual/thinkphp5/235128\" target=\"_blank\" title=\"composer包workerman\">composer包workerman</a>在这篇文章里介绍了tp5融合workerman的教程，但是介绍的过于简洁，我试验了两次并没有走通，而在这次的记录中我将我的融合过程和这个方法进行对比，分析以前没有走通的原因。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em;\">不论在哪个方法中，我们都需要将wokerman的包引入，我们需要用到composer，没有安装composer的同学需要自行安装。</p><p style=\"text-indent: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第一步</h1><p><br/></p><p style=\"text-indent: 2em;\"><span style=\"text-indent: 2em;\">导入workerman包：</span></p><pre class=\"brush:html;toolbar:false;\">composer&nbsp;require&nbsp;topthink/think-worker</pre><p style=\"text-indent: 2em;\">&nbsp;如果<span style=\"color: rgb(255, 0, 0);\">windows服务器</span>还要利用以下命令：<br/></p><pre class=\"brush:bash;toolbar:false\">composer&nbsp;require&nbsp;workerman/workerman-for-win</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">如</span><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">运行出现错误PHP Fatal error: Call to undefined function Workerman\\Lib\\pcntl_signal()，需要删除vendor\\workerman\\workerman，防止命名覆盖。</span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">当包引入完成后，我们会在项目根目录下的vendor文件夹下看到workerman文件夹，这样框架就引入了该项目，我们下一步需要配置服务的启动和引用。</span><br/></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\"><br/></span></span></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第二步</h1><p><br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">在这一步中我们需要将启动服务文件放入到项目根目录中，在根目录中我们新建启动服务文件server.php<br/></span></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\">代码如下：</span></span></p><pre class=\"brush:php;toolbar:false\">#!/usr/bin/env&nbsp;php\n&lt;?php\ndefine(&#39;APP_PATH&#39;,&nbsp;__DIR__&nbsp;.&nbsp;&#39;/application/&#39;);\n//这是原来的代码\n//define(&#39;BIND_MODULE&#39;,&#39;push/Worker&#39;);\n//这是我修改后的代码\ndefine(&#39;BIND_MODULE&#39;,&#39;push/Workertest/index&#39;);\n//&nbsp;加载框架引导文件\nrequire&nbsp;__DIR__&nbsp;.&nbsp;&#39;/thinkphp/start.php&#39;;</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\"></span></span>这个代码的意思是绑定workerman的模块是/application/push/Worker这个控制器，但是由于我们没有用tp5这个框架的引用方式这里我们将代码改为如上所示，直接进入到控制器的index方法，在下一步我们会介绍为什么用这种方法。我们在下一步中就会定义模块，也就是实现功能的地方：/application/push/workertest.php<br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第三步</h1><p><span style=\"color: rgb(255, 0, 0);\">在这一步开始前我们来看一下tp5开发手册中的worker.php，需要声明的是我并没用利用该方法。</span></p><p style=\"line-height: 2em; text-indent: 2em;\">&nbsp;&nbsp;&nbsp;&nbsp;一共有一个变量和5个方法，变量是定义端口和域名的，方法是分别为，连接上时，服务开始时，接到信息时，错误时，断开时的相应处理方法。</p><p>代码如下</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;think\\worker\\Server;\nclass&nbsp;Worker&nbsp;extends&nbsp;Server{&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;$socket&nbsp;=&nbsp;&#39;websocket://push.app:2346&#39;;&nbsp;&nbsp;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;收到信息\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$data\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onMessage($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&#39;我收到你的信息了&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接建立时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onConnect($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接断开时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onClose($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当客户端的连接上发生错误时触发\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$code\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$msg\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onError($connection,&nbsp;$code,&nbsp;$msg)\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;error&nbsp;$code&nbsp;$msg\\n&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;每个进程启动\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$worker\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onWorkerStart($worker)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"text-indent: 2em; line-height: 2em;\">如果用tp5给出的方法，我们需要在其他的控制器中实例化该控制器类，而在我用到该框架时没有看出该用法，误以为实现功能直接在该控制器中调用即可，当我利用到tcp链接时出现了两个链接的同时调用，在tp5文档中的这个方法，我无法同时实例化两个链接，于是我放弃了该方法，想要研究的同学可以继续研究一下，下面给出我的方法。</p><p>workertest.php代码如下：</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;Workerman\\Worker;\nuse&nbsp;Workerman\\Lib\\Timer;\nuse&nbsp;Workerman\\Connection\\AsyncTcpConnection;\nclass&nbsp;WorkerTest\n{\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connections;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connection_to_ws;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index()\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$connections&nbsp;=&nbsp;array();&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket&nbsp;=&nbsp;new&nbsp;Worker(&#39;websocket://0.0.0.0:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;设置transport开启ssl，websocket+ssl即wss\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$socket-&gt;transport&nbsp;=&nbsp;&#39;ssl&#39;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;启动1个进程对外提供服务&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;count&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//给这个进程设置一个array（）\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onConnect&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;lianjie&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onMessage&nbsp;=&nbsp;function($connection,$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(json_decode($data));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$jdata&nbsp;=&nbsp;json_decode($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($jdata-&gt;tem))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($con-&gt;endno)&amp;&amp;isset($jdata-&gt;endno)&amp;&amp;$con-&gt;endno==$jdata-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send($jdata-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;数据已接受&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;endno=$jdata-&gt;endno;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接断开时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onClose&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($connection-&gt;id))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;连接断开时删除映射\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset($this-&gt;connections[$connection-&gt;id]);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp&nbsp;=&nbsp;new&nbsp;Worker(&#39;tcp://0.0.0.0:8282&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp-&gt;onMessage&nbsp;=&nbsp;function($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_null($this-&gt;connection_to_ws))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(&#39;connect&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws&nbsp;=&nbsp;new&nbsp;AsyncTcpConnection(&#39;ws://119.29.170.92:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;connect();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;send($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($con-&gt;endno==json_decode($data)-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send(json_decode($data)-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;运行worker&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worker::runAll();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"line-height: 2em; text-indent: 2em;\">每当前端浏览器通过websoket上传给服务器对应终端号，workerman就会将本链接放入到队列，与此同时，我通过tcp获取到硬件的值，并经过AsyncTcpConnection这个workerman对象将由tcp端口获取的值转发给websoket端口，再由websoket进行遍历当前队列链接的前端浏览器，通过终端id查找并推送给对应的前端浏览器。<br/></p><p><br/></p> 由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman');
INSERT INTO `t_log` (`id`, `adminname`, `create_time`, `loginfo`) VALUES
(30, 'Admin', '2018-06-07 09:26:04', '从t_blog修改字段名为id值为93的数据，修改为thinkphp5部署workerman长连接  workerman 2 <p style=\"text-indent: 2em; line-height: 2em;\">由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman，在之前我曾经利用workerman进行聊天软件的编写，实现多人在线聊天功能，而在这之前我没有将这个博客编写成功，本次趁着这个机会，我将长连接的知识进行了复习，正好博客完成时间没有多久，于是将这次经历记录在案，以备以后自己查看学习，也方便了看到这个博文并且可能需要用到该框架的同学们。最后，<span style=\"text-indent: 32px;\">我需要感谢一位同学，他在这个项目中帮助了我很多，</span>。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在进行该教程之前，我们需要了解一下workerman这个框架和thinkphp这个框架，thinkphp框架是PHP几大框架之一，想要了解的同学们可以到<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\">ThinkPHP5.0完全开发手册</a>上进行文档的阅读，以下简称tp5，tp5框架是国产为数不多的优秀框架之一，国产的哦！<img src=\"http://img.baidu.com/hi/jx2/j_0007.gif\"/>而workerman则是在<a href=\"http://www.workerman.net/\" target=\"_self\" title=\"workerman\">workerman</a>官网上有详细的介绍，同学们可以到该网站上进行手册的查看。</p><p style=\"text-indent: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\" style=\"text-indent: 32px; white-space: normal;\">ThinkPHP5.0完全开发手册</a>里面有一篇介绍他们两个融合的文章<a href=\"https://www.kancloud.cn/manual/thinkphp5/235128\" target=\"_blank\" title=\"composer包workerman\">composer包workerman</a>在这篇文章里介绍了tp5融合workerman的教程，但是介绍的过于简洁，我试验了两次并没有走通，而在这次的记录中我将我的融合过程和这个方法进行对比，分析以前没有走通的原因。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em;\">不论在哪个方法中，我们都需要将wokerman的包引入，我们需要用到composer，没有安装composer的同学需要自行安装。</p><p style=\"text-indent: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第一步</h1><p><br/></p><p style=\"text-indent: 2em;\"><span style=\"text-indent: 2em;\">导入workerman包：</span></p><pre class=\"brush:html;toolbar:false;\">composer&nbsp;require&nbsp;topthink/think-worker</pre><p style=\"text-indent: 2em;\">&nbsp;如果<span style=\"color: rgb(255, 0, 0);\">windows服务器</span>还要利用以下命令：<br/></p><pre class=\"brush:bash;toolbar:false\">composer&nbsp;require&nbsp;workerman/workerman-for-win</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">如</span><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">运行出现错误PHP Fatal error: Call to undefined function Workerman\\Lib\\pcntl_signal()，需要删除vendor\\workerman\\workerman，防止命名覆盖。</span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">当包引入完成后，我们会在项目根目录下的vendor文件夹下看到workerman文件夹，这样框架就引入了该项目，我们下一步需要配置服务的启动和引用。</span><br/></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\"><br/></span></span></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第二步</h1><p><br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">在这一步中我们需要将启动服务文件放入到项目根目录中，在根目录中我们新建启动服务文件server.php<br/></span></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\">代码如下：</span></span></p><pre class=\"brush:php;toolbar:false\">#!/usr/bin/env&nbsp;php\n&lt;?php\ndefine(&#39;APP_PATH&#39;,&nbsp;__DIR__&nbsp;.&nbsp;&#39;/application/&#39;);\n//这是原来的代码\n//define(&#39;BIND_MODULE&#39;,&#39;push/Worker&#39;);\n//这是我修改后的代码\ndefine(&#39;BIND_MODULE&#39;,&#39;push/Workertest/index&#39;);\n//&nbsp;加载框架引导文件\nrequire&nbsp;__DIR__&nbsp;.&nbsp;&#39;/thinkphp/start.php&#39;;</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\"></span></span>这个代码的意思是绑定workerman的模块是/application/push/Worker这个控制器，但是由于我们没有用tp5这个框架的引用方式这里我们将代码改为如上所示，直接进入到控制器的index方法，在下一步我们会介绍为什么用这种方法。我们在下一步中就会定义模块，也就是实现功能的地方：/application/push/workertest.php<br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第三步</h1><p><span style=\"color: rgb(255, 0, 0);\">在这一步开始前我们来看一下tp5开发手册中的worker.php，需要声明的是我并没用利用该方法。</span></p><p style=\"line-height: 2em; text-indent: 2em;\">&nbsp;&nbsp;&nbsp;&nbsp;一共有一个变量和5个方法，变量是定义端口和域名的，方法是分别为，连接上时，服务开始时，接到信息时，错误时，断开时的相应处理方法。</p><p>代码如下</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;think\\worker\\Server;\nclass&nbsp;Worker&nbsp;extends&nbsp;Server{&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;$socket&nbsp;=&nbsp;&#39;websocket://push.app:2346&#39;;&nbsp;&nbsp;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;收到信息\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$data\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onMessage($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&#39;我收到你的信息了&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接建立时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onConnect($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接断开时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onClose($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当客户端的连接上发生错误时触发\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$code\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$msg\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onError($connection,&nbsp;$code,&nbsp;$msg)\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;error&nbsp;$code&nbsp;$msg\\n&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;每个进程启动\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$worker\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onWorkerStart($worker)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"text-indent: 2em; line-height: 2em;\">如果用tp5给出的方法，我们需要在其他的控制器中实例化该控制器类，而在我用到该框架时没有看出该用法，误以为实现功能直接在该控制器中调用即可，当我利用到tcp链接时出现了两个链接的同时调用，在tp5文档中的这个方法，我无法同时实例化两个链接，于是我放弃了该方法，想要研究的同学可以继续研究一下，下面给出我的方法。</p><p>workertest.php代码如下：</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;Workerman\\Worker;\nuse&nbsp;Workerman\\Lib\\Timer;\nuse&nbsp;Workerman\\Connection\\AsyncTcpConnection;\nclass&nbsp;WorkerTest\n{\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connections;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connection_to_ws;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index()\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$connections&nbsp;=&nbsp;array();&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket&nbsp;=&nbsp;new&nbsp;Worker(&#39;websocket://0.0.0.0:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;设置transport开启ssl，websocket+ssl即wss\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$socket-&gt;transport&nbsp;=&nbsp;&#39;ssl&#39;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;启动1个进程对外提供服务&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;count&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//给这个进程设置一个array（）\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onConnect&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;lianjie&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onMessage&nbsp;=&nbsp;function($connection,$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(json_decode($data));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$jdata&nbsp;=&nbsp;json_decode($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($jdata-&gt;tem))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($con-&gt;endno)&amp;&amp;isset($jdata-&gt;endno)&amp;&amp;$con-&gt;endno==$jdata-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send($jdata-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;数据已接受&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;endno=$jdata-&gt;endno;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接断开时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onClose&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($connection-&gt;id))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;连接断开时删除映射\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset($this-&gt;connections[$connection-&gt;id]);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp&nbsp;=&nbsp;new&nbsp;Worker(&#39;tcp://0.0.0.0:8282&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp-&gt;onMessage&nbsp;=&nbsp;function($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_null($this-&gt;connection_to_ws))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(&#39;connect&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws&nbsp;=&nbsp;new&nbsp;AsyncTcpConnection(&#39;ws://119.29.170.92:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;connect();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;send($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($con-&gt;endno==json_decode($data)-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send(json_decode($data)-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;运行worker&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worker::runAll();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"line-height: 2em; text-indent: 2em;\">每当前端浏览器通过websoket上传给服务器对应终端号，workerman就会将本链接放入到队列，与此同时，我通过tcp获取到硬件的值，并经过AsyncTcpConnection这个workerman对象将由tcp端口获取的值转发给websoket端口，再由websoket进行遍历当前队列链接的前端浏览器，通过终端id查找并推送给对应的前端浏览器。<br/></p><p><br/></p> 由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman'),
(31, 'Admin', '2018-06-07 13:50:45', '向t_blog添加php实现的简单的文件上传对比替换程序 文件上传对比替换 2 <p style=\"text-align: center;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\">php实现的简单的文件上传对比替换程序</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">毕业季无聊，突然想做个代码上传对比替换更新的程序，于是花了一两个小时做出来玩玩，正好借朋友的博客写一下。</span><br/></span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">程序通过浏览器上传zip压缩文件到服务器，服务器程序解压后将文件与原有文件一一比对，不同就用上传的新文件替换老文件。完成后删除临时解压的文件。</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">前端不用过多说明，就是简单的form表单文件上传。代码如下：</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><pre class=\"brush:html;toolbar:false\">&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&nbsp;lang=&quot;en&quot;&gt;\n&lt;head&gt;\n&lt;meta&nbsp;charset=&quot;UTF-8&quot;&gt;\n&lt;meta&nbsp;name=&quot;viewport&quot;&nbsp;content=&quot;width=device-width,&nbsp;initial-scale=1.0&quot;&gt;\n&lt;meta&nbsp;http-equiv=&quot;X-UA-Compatible&quot;&nbsp;content=&quot;ie=edge&quot;&gt;\n&lt;title&gt;上传文件&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form&nbsp;action=&quot;upload.php&quot;&nbsp;method=&quot;post&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&gt;\n&lt;input&nbsp;type=&quot;file&quot;&nbsp;name=&quot;files&quot;&nbsp;accept=&quot;application/zip&quot;&gt;\n&lt;button&nbsp;type=&quot;submit&quot;&gt;上传&lt;/button&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><p><br/><hr/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">压缩包上传服务器获取后需要解压缩，我用到了php的zip扩展。主要用到了其ZipArchive的numFiles属性和getNameIndex方法。numFiles获取压缩包中文件数量，getNameIndex方法说明如下：</span></p><pre class=\"brush:php;toolbar:false\">string&nbsp;ZipArchive::getNameIndex&nbsp;(&nbsp;int&nbsp;$index&nbsp;[,&nbsp;int&nbsp;$flags&nbsp;]&nbsp;)</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">功能是获取指定下标的文件的名字<br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">除此之外，还用到了pathinfo用于获取路径信息，copy用于将压缩包中文件复制到指定目录，具体代码如下：</span><br/></p><pre class=\"brush:php;toolbar:false\">function&nbsp;decompressing_file($files)\n{\nif($files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/zip&#39;&nbsp;||&nbsp;$files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/x-zip-compressed&#39;)\n{\n$zip&nbsp;=&nbsp;new&nbsp;zipArchive();\nif($zip-&gt;open($files[&#39;tmp_name&#39;])&nbsp;===&nbsp;true)//打开zip文件\n{\n$filepath&nbsp;=&nbsp;md5(time().$files[&#39;name&#39;]);\nmkdir($filepath);//创建临时解压目录\nfor($i=0;$i&lt;$zip-&gt;numFiles;++$i)//遍历压缩包中所有文件和目录\n{\n$filename&nbsp;=&nbsp;$zip-&gt;getNameIndex($i);//获取当前下标的文件或目录名\n$fileinfo&nbsp;=&nbsp;pathinfo($filename);//获取文件或目录路径信息\nif(!file_exists($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]))//判断当前文件的目录是否存在，不存在创建\n{\nmkdir($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]);\n}\n//由于获取的文件或目录名唯一的区别就是目录名最后是‘/’，所以以此区分\nif($filename[strlen($filename)-1]!=&#39;/&#39;)\n{\ncopy(&#39;zip://&#39;.$files[&#39;tmp_name&#39;].&#39;#&#39;.$filename,$filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;].&#39;/&#39;.$fileinfo[&#39;basename&#39;]);\n//如是文件，将其复制到临时目录\n}\n}\n$zip-&gt;close();//关闭压缩文件\nreturn&nbsp;$filepath;\n}\n}\nreturn&nbsp;null;\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"><br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><hr/><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">解压后就是与旧文件对比替换了，思路就是获取文件夹目录中的所有文件和目录，如是目录，递归处理，如是文件，先判断其与旧文件的修改时间是否相同，相同就说明文件没有修改过，不用替换，如不相同，再比较两个文件的哈希散列值，如相同，说明文件内容没有改动，不用替换。否则，替换。当然，如果无相应旧文件，也要进行复制操作。代码如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;files_replace($frompath,$topath)\n{\nif(!file_exists($topath))\n{\nmkdir($topath);\n}\n$files&nbsp;=&nbsp;scandir($frompath);//获取指定目录下的所有文件和目录数组\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)//因为获取的信息有上级目录‘..’和当前目录‘.’，不需处理，直接略过\n{\ncontinue;\n}\nif(is_dir($frompath.&#39;/&#39;.$files[$i]))//如是目录，递归处理\n{\nfiles_replace($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\n$needtoreplace&nbsp;=&nbsp;true;//标记文件是否需要复制，默认置为需要\nif(file_exists($topath.&#39;/&#39;.$files[$i]))//判断旧文件是否存在相应文件\n{\nif(filemtime($frompath.&#39;/&#39;.$files[$i])&nbsp;==&nbsp;filemtime($topath.&#39;/&#39;.$files[$i]))//判断两个文件修改时间是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\nelse\n{\n$oldfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$frompath.&#39;/&#39;.$files[$i]);\n$newfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$topath.&#39;/&#39;.$files[$i]);\nif($oldfilehash&nbsp;==&nbsp;$newfilehash)//判断两个文件哈希散列值是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\n}\n}\nif($needtoreplace)\n{\ncopy($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);//将新文件拷贝到对应位置\necho(&#39;replacefile:&#39;.$topath.&#39;/&#39;.$files[$i].&quot;&lt;br/&gt;&quot;);\n}\n}\n}\n}</pre><p><br/></p><hr/><p></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">最后就是删除临时的解压文件了，由于没有直接的删除非空目录的方法，采用循环加递归的方法级联删除所有文件，实现</span><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;delete_files($filepath)\n{\n$files&nbsp;=&nbsp;scandir($filepath);\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)\n{\ncontinue;\n}\nif(is_dir($filepath.&#39;/&#39;.$files[$i]))\n{\ndelete_files($filepath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\nunlink($filepath.&#39;/&#39;.$files[$i]);\n}\n}\nrmdir($filepath);\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">完整的程序在我的github上：</span><a href=\"https://github.com/Taurus-uomini/files_replace\" target=\"_self\">https://github.com/Taurus-uomini/files_replace</a></p>  0 0'),
(32, 'Admin', '2018-06-07 13:51:09', '向t_blogtype添加php '),
(33, 'Admin', '2018-06-07 13:51:52', '从t_blog修改字段名为id值为94的数据，修改为php实现的简单的文件上传对比替换程序 文件上传对比替换 16 <p style=\"text-align: center;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\">php实现的简单的文件上传对比替换程序</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">毕业季无聊，突然想做个代码上传对比替换更新的程序，于是花了一两个小时做出来玩玩，正好借朋友的博客写一下。</span><br/></span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">程序通过浏览器上传zip压缩文件到服务器，服务器程序解压后将文件与原有文件一一比对，不同就用上传的新文件替换老文件。完成后删除临时解压的文件。</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">前端不用过多说明，就是简单的form表单文件上传。代码如下：</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><pre class=\"brush:html;toolbar:false\">&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&nbsp;lang=&quot;en&quot;&gt;\n&lt;head&gt;\n&lt;meta&nbsp;charset=&quot;UTF-8&quot;&gt;\n&lt;meta&nbsp;name=&quot;viewport&quot;&nbsp;content=&quot;width=device-width,&nbsp;initial-scale=1.0&quot;&gt;\n&lt;meta&nbsp;http-equiv=&quot;X-UA-Compatible&quot;&nbsp;content=&quot;ie=edge&quot;&gt;\n&lt;title&gt;上传文件&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form&nbsp;action=&quot;upload.php&quot;&nbsp;method=&quot;post&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&gt;\n&lt;input&nbsp;type=&quot;file&quot;&nbsp;name=&quot;files&quot;&nbsp;accept=&quot;application/zip&quot;&gt;\n&lt;button&nbsp;type=&quot;submit&quot;&gt;上传&lt;/button&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><p><br/></p><hr/><p></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">压缩包上传服务器获取后需要解压缩，我用到了php的zip扩展。主要用到了其ZipArchive的numFiles属性和getNameIndex方法。numFiles获取压缩包中文件数量，getNameIndex方法说明如下：</span></p><pre class=\"brush:php;toolbar:false\">string&nbsp;ZipArchive::getNameIndex&nbsp;(&nbsp;int&nbsp;$index&nbsp;[,&nbsp;int&nbsp;$flags&nbsp;]&nbsp;)</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">功能是获取指定下标的文件的名字<br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">除此之外，还用到了pathinfo用于获取路径信息，copy用于将压缩包中文件复制到指定目录，具体代码如下：</span><br/></p><pre class=\"brush:php;toolbar:false\">function&nbsp;decompressing_file($files)\n{\nif($files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/zip&#39;&nbsp;||&nbsp;$files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/x-zip-compressed&#39;)\n{\n$zip&nbsp;=&nbsp;new&nbsp;zipArchive();\nif($zip-&gt;open($files[&#39;tmp_name&#39;])&nbsp;===&nbsp;true)//打开zip文件\n{\n$filepath&nbsp;=&nbsp;md5(time().$files[&#39;name&#39;]);\nmkdir($filepath);//创建临时解压目录\nfor($i=0;$i&lt;$zip-&gt;numFiles;++$i)//遍历压缩包中所有文件和目录\n{\n$filename&nbsp;=&nbsp;$zip-&gt;getNameIndex($i);//获取当前下标的文件或目录名\n$fileinfo&nbsp;=&nbsp;pathinfo($filename);//获取文件或目录路径信息\nif(!file_exists($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]))//判断当前文件的目录是否存在，不存在创建\n{\nmkdir($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]);\n}\n//由于获取的文件或目录名唯一的区别就是目录名最后是‘/’，所以以此区分\nif($filename[strlen($filename)-1]!=&#39;/&#39;)\n{\ncopy(&#39;zip://&#39;.$files[&#39;tmp_name&#39;].&#39;#&#39;.$filename,$filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;].&#39;/&#39;.$fileinfo[&#39;basename&#39;]);\n//如是文件，将其复制到临时目录\n}\n}\n$zip-&gt;close();//关闭压缩文件\nreturn&nbsp;$filepath;\n}\n}\nreturn&nbsp;null;\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"><br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><hr/><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">解压后就是与旧文件对比替换了，思路就是获取文件夹目录中的所有文件和目录，如是目录，递归处理，如是文件，先判断其与旧文件的修改时间是否相同，相同就说明文件没有修改过，不用替换，如不相同，再比较两个文件的哈希散列值，如相同，说明文件内容没有改动，不用替换。否则，替换。当然，如果无相应旧文件，也要进行复制操作。代码如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;files_replace($frompath,$topath)\n{\nif(!file_exists($topath))\n{\nmkdir($topath);\n}\n$files&nbsp;=&nbsp;scandir($frompath);//获取指定目录下的所有文件和目录数组\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)//因为获取的信息有上级目录‘..’和当前目录‘.’，不需处理，直接略过\n{\ncontinue;\n}\nif(is_dir($frompath.&#39;/&#39;.$files[$i]))//如是目录，递归处理\n{\nfiles_replace($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\n$needtoreplace&nbsp;=&nbsp;true;//标记文件是否需要复制，默认置为需要\nif(file_exists($topath.&#39;/&#39;.$files[$i]))//判断旧文件是否存在相应文件\n{\nif(filemtime($frompath.&#39;/&#39;.$files[$i])&nbsp;==&nbsp;filemtime($topath.&#39;/&#39;.$files[$i]))//判断两个文件修改时间是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\nelse\n{\n$oldfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$frompath.&#39;/&#39;.$files[$i]);\n$newfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$topath.&#39;/&#39;.$files[$i]);\nif($oldfilehash&nbsp;==&nbsp;$newfilehash)//判断两个文件哈希散列值是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\n}\n}\nif($needtoreplace)\n{\ncopy($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);//将新文件拷贝到对应位置\necho(&#39;replacefile:&#39;.$topath.&#39;/&#39;.$files[$i].&quot;&lt;br/&gt;&quot;);\n}\n}\n}\n}</pre><p><br/></p><hr/><p><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">最后就是删除临时的解压文件了，由于没有直接的删除非空目录的方法，采用循环加递归的方法级联删除所有文件，实现</span><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;delete_files($filepath)\n{\n$files&nbsp;=&nbsp;scandir($filepath);\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)\n{\ncontinue;\n}\nif(is_dir($filepath.&#39;/&#39;.$files[$i]))\n{\ndelete_files($filepath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\nunlink($filepath.&#39;/&#39;.$files[$i]);\n}\n}\nrmdir($filepath);\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">完整的程序在我的github上：</span><a href=\"https://github.com/Taurus-uomini/files_replace\" target=\"_self\">https://github.com/Taurus-uomini/files_replace</a></p> '),
(34, 'Admin', '2018-06-07 13:53:37', '从t_blog修改字段名为id值为94的数据，修改为php实现的简单的文件上传对比替换程序 文件上传对比替换 2 <p style=\"text-align: center;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\">php实现的简单的文件上传对比替换程序</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">毕业季无聊，突然想做个代码上传对比替换更新的程序，于是花了一两个小时做出来玩玩，正好借朋友的博客写一下。</span><br/></span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">程序通过浏览器上传zip压缩文件到服务器，服务器程序解压后将文件与原有文件一一比对，不同就用上传的新文件替换老文件。完成后删除临时解压的文件。</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">前端不用过多说明，就是简单的form表单文件上传。代码如下：</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><pre class=\"brush:html;toolbar:false\">&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&nbsp;lang=&quot;en&quot;&gt;\n&lt;head&gt;\n&lt;meta&nbsp;charset=&quot;UTF-8&quot;&gt;\n&lt;meta&nbsp;name=&quot;viewport&quot;&nbsp;content=&quot;width=device-width,&nbsp;initial-scale=1.0&quot;&gt;\n&lt;meta&nbsp;http-equiv=&quot;X-UA-Compatible&quot;&nbsp;content=&quot;ie=edge&quot;&gt;\n&lt;title&gt;上传文件&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form&nbsp;action=&quot;upload.php&quot;&nbsp;method=&quot;post&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&gt;\n&lt;input&nbsp;type=&quot;file&quot;&nbsp;name=&quot;files&quot;&nbsp;accept=&quot;application/zip&quot;&gt;\n&lt;button&nbsp;type=&quot;submit&quot;&gt;上传&lt;/button&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><p><br/></p><hr/><p><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">压缩包上传服务器获取后需要解压缩，我用到了php的zip扩展。主要用到了其ZipArchive的numFiles属性和getNameIndex方法。numFiles获取压缩包中文件数量，getNameIndex方法说明如下：</span></p><pre class=\"brush:php;toolbar:false\">string&nbsp;ZipArchive::getNameIndex&nbsp;(&nbsp;int&nbsp;$index&nbsp;[,&nbsp;int&nbsp;$flags&nbsp;]&nbsp;)</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">功能是获取指定下标的文件的名字<br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">除此之外，还用到了pathinfo用于获取路径信息，copy用于将压缩包中文件复制到指定目录，具体代码如下：</span><br/></p><pre class=\"brush:php;toolbar:false\">function&nbsp;decompressing_file($files)\n{\nif($files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/zip&#39;&nbsp;||&nbsp;$files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/x-zip-compressed&#39;)\n{\n$zip&nbsp;=&nbsp;new&nbsp;zipArchive();\nif($zip-&gt;open($files[&#39;tmp_name&#39;])&nbsp;===&nbsp;true)//打开zip文件\n{\n$filepath&nbsp;=&nbsp;md5(time().$files[&#39;name&#39;]);\nmkdir($filepath);//创建临时解压目录\nfor($i=0;$i&lt;$zip-&gt;numFiles;++$i)//遍历压缩包中所有文件和目录\n{\n$filename&nbsp;=&nbsp;$zip-&gt;getNameIndex($i);//获取当前下标的文件或目录名\n$fileinfo&nbsp;=&nbsp;pathinfo($filename);//获取文件或目录路径信息\nif(!file_exists($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]))//判断当前文件的目录是否存在，不存在创建\n{\nmkdir($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]);\n}\n//由于获取的文件或目录名唯一的区别就是目录名最后是‘/’，所以以此区分\nif($filename[strlen($filename)-1]!=&#39;/&#39;)\n{\ncopy(&#39;zip://&#39;.$files[&#39;tmp_name&#39;].&#39;#&#39;.$filename,$filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;].&#39;/&#39;.$fileinfo[&#39;basename&#39;]);\n//如是文件，将其复制到临时目录\n}\n}\n$zip-&gt;close();//关闭压缩文件\nreturn&nbsp;$filepath;\n}\n}\nreturn&nbsp;null;\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"><br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><hr/><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">解压后就是与旧文件对比替换了，思路就是获取文件夹目录中的所有文件和目录，如是目录，递归处理，如是文件，先判断其与旧文件的修改时间是否相同，相同就说明文件没有修改过，不用替换，如不相同，再比较两个文件的哈希散列值，如相同，说明文件内容没有改动，不用替换。否则，替换。当然，如果无相应旧文件，也要进行复制操作。代码如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;files_replace($frompath,$topath)\n{\nif(!file_exists($topath))\n{\nmkdir($topath);\n}\n$files&nbsp;=&nbsp;scandir($frompath);//获取指定目录下的所有文件和目录数组\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)//因为获取的信息有上级目录‘..’和当前目录‘.’，不需处理，直接略过\n{\ncontinue;\n}\nif(is_dir($frompath.&#39;/&#39;.$files[$i]))//如是目录，递归处理\n{\nfiles_replace($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\n$needtoreplace&nbsp;=&nbsp;true;//标记文件是否需要复制，默认置为需要\nif(file_exists($topath.&#39;/&#39;.$files[$i]))//判断旧文件是否存在相应文件\n{\nif(filemtime($frompath.&#39;/&#39;.$files[$i])&nbsp;==&nbsp;filemtime($topath.&#39;/&#39;.$files[$i]))//判断两个文件修改时间是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\nelse\n{\n$oldfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$frompath.&#39;/&#39;.$files[$i]);\n$newfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$topath.&#39;/&#39;.$files[$i]);\nif($oldfilehash&nbsp;==&nbsp;$newfilehash)//判断两个文件哈希散列值是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\n}\n}\nif($needtoreplace)\n{\ncopy($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);//将新文件拷贝到对应位置\necho(&#39;replacefile:&#39;.$topath.&#39;/&#39;.$files[$i].&quot;&lt;br/&gt;&quot;);\n}\n}\n}\n}</pre><p><br/></p><hr/><p><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">最后就是删除临时的解压文件了，由于没有直接的删除非空目录的方法，采用循环加递归的方法级联删除所有文件，实现</span><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;delete_files($filepath)\n{\n$files&nbsp;=&nbsp;scandir($filepath);\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)\n{\ncontinue;\n}\nif(is_dir($filepath.&#39;/&#39;.$files[$i]))\n{\ndelete_files($filepath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\nunlink($filepath.&#39;/&#39;.$files[$i]);\n}\n}\nrmdir($filepath);\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">完整的程序在我的github上：</span><a href=\"https://github.com/Taurus-uomini/files_replace\" target=\"_self\">https://github.com/Taurus-uomini/files_replace</a></p> php实现的简单的文件上传对比替换程序。通过上传压缩包，程序会解压文件，并与已存在文件进行比较，进行文件更新。只支持zip压缩文件上传。'),
(35, 'Admin', '2018-06-07 13:55:16', '从t_blog修改字段名为id值为94的数据，修改为php实现的简单的文件上传对比替换程序 文件上传对比替换 16 <p style=\"text-align: center;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\">php实现的简单的文件上传对比替换程序</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 24px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">毕业季无聊，突然想做个代码上传对比替换更新的程序，于是花了一两个小时做出来玩玩，正好借朋友的博客写一下。</span><br/></span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">程序通过浏览器上传zip压缩文件到服务器，服务器程序解压后将文件与原有文件一一比对，不同就用上传的新文件替换老文件。完成后删除临时解压的文件。</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">前端不用过多说明，就是简单的form表单文件上传。代码如下：</span></p><p style=\"margin-top: 5px;\"><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><pre class=\"brush:html;toolbar:false\">&lt;!DOCTYPE&nbsp;html&gt;\n&lt;html&nbsp;lang=&quot;en&quot;&gt;\n&lt;head&gt;\n&lt;meta&nbsp;charset=&quot;UTF-8&quot;&gt;\n&lt;meta&nbsp;name=&quot;viewport&quot;&nbsp;content=&quot;width=device-width,&nbsp;initial-scale=1.0&quot;&gt;\n&lt;meta&nbsp;http-equiv=&quot;X-UA-Compatible&quot;&nbsp;content=&quot;ie=edge&quot;&gt;\n&lt;title&gt;上传文件&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form&nbsp;action=&quot;upload.php&quot;&nbsp;method=&quot;post&quot;&nbsp;enctype=&quot;multipart/form-data&quot;&gt;\n&lt;input&nbsp;type=&quot;file&quot;&nbsp;name=&quot;files&quot;&nbsp;accept=&quot;application/zip&quot;&gt;\n&lt;button&nbsp;type=&quot;submit&quot;&gt;上传&lt;/button&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><p><br/></p><hr/><p><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">压缩包上传服务器获取后需要解压缩，我用到了php的zip扩展。主要用到了其ZipArchive的numFiles属性和getNameIndex方法。numFiles获取压缩包中文件数量，getNameIndex方法说明如下：</span></p><pre class=\"brush:php;toolbar:false\">string&nbsp;ZipArchive::getNameIndex&nbsp;(&nbsp;int&nbsp;$index&nbsp;[,&nbsp;int&nbsp;$flags&nbsp;]&nbsp;)</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">功能是获取指定下标的文件的名字<br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">除此之外，还用到了pathinfo用于获取路径信息，copy用于将压缩包中文件复制到指定目录，具体代码如下：</span><br/></p><pre class=\"brush:php;toolbar:false\">function&nbsp;decompressing_file($files)\n{\nif($files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/zip&#39;&nbsp;||&nbsp;$files[&#39;type&#39;]&nbsp;==&nbsp;&#39;application/x-zip-compressed&#39;)\n{\n$zip&nbsp;=&nbsp;new&nbsp;zipArchive();\nif($zip-&gt;open($files[&#39;tmp_name&#39;])&nbsp;===&nbsp;true)//打开zip文件\n{\n$filepath&nbsp;=&nbsp;md5(time().$files[&#39;name&#39;]);\nmkdir($filepath);//创建临时解压目录\nfor($i=0;$i&lt;$zip-&gt;numFiles;++$i)//遍历压缩包中所有文件和目录\n{\n$filename&nbsp;=&nbsp;$zip-&gt;getNameIndex($i);//获取当前下标的文件或目录名\n$fileinfo&nbsp;=&nbsp;pathinfo($filename);//获取文件或目录路径信息\nif(!file_exists($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]))//判断当前文件的目录是否存在，不存在创建\n{\nmkdir($filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;]);\n}\n//由于获取的文件或目录名唯一的区别就是目录名最后是‘/’，所以以此区分\nif($filename[strlen($filename)-1]!=&#39;/&#39;)\n{\ncopy(&#39;zip://&#39;.$files[&#39;tmp_name&#39;].&#39;#&#39;.$filename,$filepath.&#39;/&#39;.$fileinfo[&#39;dirname&#39;].&#39;/&#39;.$fileinfo[&#39;basename&#39;]);\n//如是文件，将其复制到临时目录\n}\n}\n$zip-&gt;close();//关闭压缩文件\nreturn&nbsp;$filepath;\n}\n}\nreturn&nbsp;null;\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"><br/></span></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span></p><hr/><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\"></span><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">解压后就是与旧文件对比替换了，思路就是获取文件夹目录中的所有文件和目录，如是目录，递归处理，如是文件，先判断其与旧文件的修改时间是否相同，相同就说明文件没有修改过，不用替换，如不相同，再比较两个文件的哈希散列值，如相同，说明文件内容没有改动，不用替换。否则，替换。当然，如果无相应旧文件，也要进行复制操作。代码如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;files_replace($frompath,$topath)\n{\nif(!file_exists($topath))\n{\nmkdir($topath);\n}\n$files&nbsp;=&nbsp;scandir($frompath);//获取指定目录下的所有文件和目录数组\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)//因为获取的信息有上级目录‘..’和当前目录‘.’，不需处理，直接略过\n{\ncontinue;\n}\nif(is_dir($frompath.&#39;/&#39;.$files[$i]))//如是目录，递归处理\n{\nfiles_replace($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\n$needtoreplace&nbsp;=&nbsp;true;//标记文件是否需要复制，默认置为需要\nif(file_exists($topath.&#39;/&#39;.$files[$i]))//判断旧文件是否存在相应文件\n{\nif(filemtime($frompath.&#39;/&#39;.$files[$i])&nbsp;==&nbsp;filemtime($topath.&#39;/&#39;.$files[$i]))//判断两个文件修改时间是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\nelse\n{\n$oldfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$frompath.&#39;/&#39;.$files[$i]);\n$newfilehash&nbsp;=&nbsp;hash_file(&#39;md5&#39;,$topath.&#39;/&#39;.$files[$i]);\nif($oldfilehash&nbsp;==&nbsp;$newfilehash)//判断两个文件哈希散列值是否相同\n{\n$needtoreplace&nbsp;=&nbsp;false;\n}\n}\n}\nif($needtoreplace)\n{\ncopy($frompath.&#39;/&#39;.$files[$i],$topath.&#39;/&#39;.$files[$i]);//将新文件拷贝到对应位置\necho(&#39;replacefile:&#39;.$topath.&#39;/&#39;.$files[$i].&quot;&lt;br/&gt;&quot;);\n}\n}\n}\n}</pre><p><br/></p><hr/><p><br/></p><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">最后就是删除临时的解压文件了，由于没有直接的删除非空目录的方法，采用循环加递归的方法级联删除所有文件，实现</span><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">如下：</span></p><pre class=\"brush:php;toolbar:false\">function&nbsp;delete_files($filepath)\n{\n$files&nbsp;=&nbsp;scandir($filepath);\nfor($i=0;$i&lt;count($files);++$i)\n{\nif($files[$i]==&#39;.&#39;||$files[$i]==&#39;..&#39;)\n{\ncontinue;\n}\nif(is_dir($filepath.&#39;/&#39;.$files[$i]))\n{\ndelete_files($filepath.&#39;/&#39;.$files[$i]);\n}\nelse\n{\nunlink($filepath.&#39;/&#39;.$files[$i]);\n}\n}\nrmdir($filepath);\n}</pre><p><span style=\"color: rgb(36, 41, 46); background-color: rgb(255, 255, 255); font-family: 宋体, SimSun; font-size: 16px;\">完整的程序在我的github上：</span><a href=\"https://github.com/Taurus-uomini/files_replace\" target=\"_self\">https://github.com/Taurus-uomini/files_replace</a></p> php实现的简单的文件上传对比替换程序。通过上传压缩包，程序会解压文件，并与已存在文件进行比较，进行文件更新。只支持zip压缩文件上传。');
INSERT INTO `t_log` (`id`, `adminname`, `create_time`, `loginfo`) VALUES
(36, 'Admin', '2018-06-08 09:10:00', '从t_blog修改字段名为id值为93的数据，修改为thinkphp5部署workerman长连接   16 <p style=\"text-indent: 2em; line-height: 2em;\">由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman，在之前我曾经利用workerman进行聊天软件的编写，实现多人在线聊天功能，而在这之前我没有将这个博客编写成功，本次趁着这个机会，我将长连接的知识进行了复习，正好博客完成时间没有多久，于是将这次经历记录在案，以备以后自己查看学习，也方便了看到这个博文并且可能需要用到该框架的同学们。最后，<span style=\"text-indent: 32px;\">我需要感谢一位同学，他在这个项目中帮助了我很多，</span>。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在进行该教程之前，我们需要了解一下workerman这个框架和thinkphp这个框架，thinkphp框架是PHP几大框架之一，想要了解的同学们可以到<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\">ThinkPHP5.0完全开发手册</a>上进行文档的阅读，以下简称tp5，tp5框架是国产为数不多的优秀框架之一，国产的哦！<img src=\"http://img.baidu.com/hi/jx2/j_0007.gif\"/>而workerman则是在<a href=\"http://www.workerman.net/\" target=\"_self\" title=\"workerman\">workerman</a>官网上有详细的介绍，同学们可以到该网站上进行手册的查看。</p><p style=\"text-indent: 2em;\"><br/></p><p style=\"text-indent: 2em; line-height: 2em;\">在<a href=\"https://www.kancloud.cn/manual/thinkphp5\" target=\"_blank\" title=\"ThinkPHP5.0完全开发手册\" style=\"text-indent: 32px; white-space: normal;\">ThinkPHP5.0完全开发手册</a>里面有一篇介绍他们两个融合的文章<a href=\"https://www.kancloud.cn/manual/thinkphp5/235128\" target=\"_blank\" title=\"composer包workerman\">composer包workerman</a>在这篇文章里介绍了tp5融合workerman的教程，但是介绍的过于简洁，我试验了两次并没有走通，而在这次的记录中我将我的融合过程和这个方法进行对比，分析以前没有走通的原因。</p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><p style=\"text-indent: 2em;\">不论在哪个方法中，我们都需要将wokerman的包引入，我们需要用到composer，没有安装composer的同学需要自行安装。</p><p style=\"text-indent: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第一步</h1><p><br/></p><p style=\"text-indent: 2em;\"><span style=\"text-indent: 2em;\">导入workerman包：</span></p><pre class=\"brush:html;toolbar:false;\">composer&nbsp;require&nbsp;topthink/think-worker</pre><p style=\"text-indent: 2em;\">&nbsp;如果<span style=\"color: rgb(255, 0, 0);\">windows服务器</span>还要利用以下命令：<br/></p><pre class=\"brush:bash;toolbar:false\">composer&nbsp;require&nbsp;workerman/workerman-for-win</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">如</span><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\">运行出现错误PHP Fatal error: Call to undefined function Workerman\\Lib\\pcntl_signal()，需要删除vendor\\workerman\\workerman，防止命名覆盖。</span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">当包引入完成后，我们会在项目根目录下的vendor文件夹下看到workerman文件夹，这样框架就引入了该项目，我们下一步需要配置服务的启动和引用。</span><br/></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\"><br/></span></span></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第二步</h1><p><br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0);\"><span style=\"font-family: &quot;Microsoft Yahei&quot;, &quot;Helvetica Neue&quot;, Arial, Helvetica, sans-serif; font-size: 15.96px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);\">在这一步中我们需要将启动服务文件放入到项目根目录中，在根目录中我们新建启动服务文件server.php<br/></span></span></p><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\">代码如下：</span></span></p><pre class=\"brush:php;toolbar:false\">#!/usr/bin/env&nbsp;php\n&lt;?php\ndefine(&#39;APP_PATH&#39;,&nbsp;__DIR__&nbsp;.&nbsp;&#39;/application/&#39;);\n//这是原来的代码\n//define(&#39;BIND_MODULE&#39;,&#39;push/Worker&#39;);\n//这是我修改后的代码\ndefine(&#39;BIND_MODULE&#39;,&#39;push/Workertest/index&#39;);\n//&nbsp;加载框架引导文件\nrequire&nbsp;__DIR__&nbsp;.&nbsp;&#39;/thinkphp/start.php&#39;;</pre><p style=\"text-indent: 2em; line-height: 2em;\"><span style=\"font-family:Microsoft Yahei, Helvetica Neue, Arial, Helvetica, sans-serif\"><span style=\"font-size: 15.96px; background-color: rgb(255, 255, 255);\"></span></span>这个代码的意思是绑定workerman的模块是/application/push/Worker这个控制器，但是由于我们没有用tp5这个框架的引用方式这里我们将代码改为如上所示，直接进入到控制器的index方法，在下一步我们会介绍为什么用这种方法。我们在下一步中就会定义模块，也就是实现功能的地方：/application/push/workertest.php<br/></p><p style=\"text-indent: 2em; line-height: 2em;\"><br/></p><h1 style=\"font-size: 32px; font-weight: bold; border-bottom: 2px solid rgb(204, 204, 204); padding: 0px 4px 0px 0px; text-align: left; margin: 0px 0px 10px;\">第三步</h1><p><span style=\"color: rgb(255, 0, 0);\">在这一步开始前我们来看一下tp5开发手册中的worker.php，需要声明的是我并没用利用该方法。</span></p><p style=\"line-height: 2em; text-indent: 2em;\">&nbsp;&nbsp;&nbsp;&nbsp;一共有一个变量和5个方法，变量是定义端口和域名的，方法是分别为，连接上时，服务开始时，接到信息时，错误时，断开时的相应处理方法。</p><p>代码如下</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;think\\worker\\Server;\nclass&nbsp;Worker&nbsp;extends&nbsp;Server{&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;$socket&nbsp;=&nbsp;&#39;websocket://push.app:2346&#39;;&nbsp;&nbsp;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;收到信息\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$data\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onMessage($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&#39;我收到你的信息了&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接建立时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onConnect($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当连接断开时触发的回调函数\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onClose($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;当客户端的连接上发生错误时触发\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$connection\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$code\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$msg\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onError($connection,&nbsp;$code,&nbsp;$msg)\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;error&nbsp;$code&nbsp;$msg\\n&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;/**\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;每个进程启动\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$worker\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;onWorkerStart($worker)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"text-indent: 2em; line-height: 2em;\">如果用tp5给出的方法，我们需要在其他的控制器中实例化该控制器类，而在我用到该框架时没有看出该用法，误以为实现功能直接在该控制器中调用即可，当我利用到tcp链接时出现了两个链接的同时调用，在tp5文档中的这个方法，我无法同时实例化两个链接，于是我放弃了该方法，想要研究的同学可以继续研究一下，下面给出我的方法。</p><p>workertest.php代码如下：</p><pre class=\"brush:php;toolbar:false\">&lt;?php\nnamespace&nbsp;app\\push\\controller;\nuse&nbsp;Workerman\\Worker;\nuse&nbsp;Workerman\\Lib\\Timer;\nuse&nbsp;Workerman\\Connection\\AsyncTcpConnection;\nclass&nbsp;WorkerTest\n{\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connections;\n&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;$connection_to_ws;\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;index()\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$connections&nbsp;=&nbsp;array();&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket&nbsp;=&nbsp;new&nbsp;Worker(&#39;websocket://0.0.0.0:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;设置transport开启ssl，websocket+ssl即wss\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;$socket-&gt;transport&nbsp;=&nbsp;&#39;ssl&#39;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;启动1个进程对外提供服务&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;count&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//给这个进程设置一个array（）\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onConnect&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;lianjie&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onMessage&nbsp;=&nbsp;function($connection,$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(json_decode($data));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$jdata&nbsp;=&nbsp;json_decode($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($jdata-&gt;tem))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($con-&gt;endno)&amp;&amp;isset($jdata-&gt;endno)&amp;&amp;$con-&gt;endno==$jdata-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send($jdata-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;send(&quot;数据已接受&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$connection-&gt;endno=$jdata-&gt;endno;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connections[$connection-&gt;id]=$connection;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;当有客户端连接断开时\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$socket-&gt;onClose&nbsp;=&nbsp;function($connection)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($connection-&gt;id))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;连接断开时删除映射\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unset($this-&gt;connections[$connection-&gt;id]);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp&nbsp;=&nbsp;new&nbsp;Worker(&#39;tcp://0.0.0.0:8282&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tcp-&gt;onMessage&nbsp;=&nbsp;function($connection,&nbsp;$data)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(is_null($this-&gt;connection_to_ws))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump(&#39;connect&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws&nbsp;=&nbsp;new&nbsp;AsyncTcpConnection(&#39;ws://119.29.170.92:2346&#39;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;connect();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;connection_to_ws-&gt;send($data);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var_dump(count($this-&gt;connections));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;foreach($this-&gt;connections&nbsp;as&nbsp;$con){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($con-&gt;endno==json_decode($data)-&gt;endno){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$con-&gt;send(json_decode($data)-&gt;tem);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;运行worker&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Worker::runAll();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n}</pre><p style=\"line-height: 2em; text-indent: 2em;\">每当前端浏览器通过websoket上传给服务器对应终端号，workerman就会将本链接放入到队列，与此同时，我通过tcp获取到硬件的值，并经过AsyncTcpConnection这个workerman对象将由tcp端口获取的值转发给websoket端口，再由websoket进行遍历当前队列链接的前端浏览器，通过终端id查找并推送给对应的前端浏览器。<br/></p><p><br/></p> 由于最近做一个物联网项目，该项目需要远程将温度推送到服务器，并由服务器推送到web前台，硬件可以利用tcp协议将数据上传到到服务器，但是由于不固定ip的原因，服务器是找不到web前端的，而在这个时候我们就需要利用到长连接workerman'),
(37, 'Admin', '2018-06-08 09:10:21', '从t_blog修改字段名为id值为90的数据，修改为第一篇博文   5 <p style=\"line-height: 1.5em; text-align: left; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\">这个博客在2018年4月</span><span style=\"text-indent: 2em; font-size: 20px;\"></span><span style=\"font-size: 18px; text-indent: 2em;\">完成了，写这篇博文的时候是博客刚刚完成了后台功能，前台界面我还没有写，但是我抑制不住自己写这篇博客的欲望。在大学四年跌跌撞撞也算是做了人生旅途这一阶段的路程吧，我一直相信人生的每一段旅途应该完成的事情是不同的，而我的大学生涯过的并不算很华丽，但是确让我感到清晰和完整。人们都说大学生涯应该是轻松和快乐的，对于这件事我深以为然，追一下自己喜欢的姑娘，干一些自己喜欢的事情，或者交上一大群同样不求上进的朋友。大学时间过的真是快，一不小心自己就临近毕业，工作当然很辛苦，但是人生不可缺少的一部分。最后以此文章证明我大学生涯的结束和这个博客的起始。</span><br/></p><p style=\"line-height: 1.5em; text-align: center; text-indent: 2em;\"><span style=\"font-size: 18px; text-indent: 2em;\"><img src=\"/tp50/public/upload/image/20180418/1524041983.jpg\" title=\"1524041983.jpg\" alt=\"9f3d80e7e814a80588434bda4c2a6843.jpg\" width=\"611\" height=\"300\"/></span></p> 这是这个网站的第一篇博文，一直都想做一个自己的博客，但我这个人相对较懒，没有缘由，我可能一辈子都完不成这个任务。这次借着做毕业设计的机会，刚好完成想了几年也没动手去做的事情。'),
(38, 'Admin', '2018-06-22 15:26:45', '向t_blog添加ddd fffd 13  多少多少 0 0'),
(39, 'Admin', '2018-06-22 15:28:36', '向t_blog添加dfdgdf hhngf 13 <p>从v不能发你发南宁vv年出版v那边v你</p> 交给警方经过黑猫白猫\n不v那边v那你发你 0 0'),
(40, 'Admin', '2018-06-22 15:29:53', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180413/5ad02cb9f0062.jpg'),
(41, 'Admin', '2018-06-22 15:29:57', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180413/5ad02cb9f0062.jpg'),
(42, 'Admin', '2018-06-22 15:29:57', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180413/5ad02cbf2b09d.jpg'),
(43, 'Admin', '2018-06-22 15:29:57', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180413/5ad02cc2a5e5f.jpg'),
(44, 'Admin', '2018-06-22 15:29:57', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(45, 'Admin', '2018-06-22 15:30:39', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180413/5ad02cb9f0062.jpg'),
(46, 'Admin', '2018-06-22 15:30:39', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180622/5b2d1618bb17c.com-225321'),
(47, 'Admin', '2018-06-22 15:30:39', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180413/5ad02cc2a5e5f.jpg'),
(48, 'Admin', '2018-06-22 15:30:40', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(49, 'Admin', '2018-06-22 15:31:13', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180622/5b2d163b08cd9.jpg'),
(50, 'Admin', '2018-06-22 15:31:13', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180622/5b2d1618bb17c.com-225321'),
(51, 'Admin', '2018-06-22 15:31:13', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180622/5b2d163178169.jpg'),
(52, 'Admin', '2018-06-22 15:31:13', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(53, 'Admin', '2018-06-22 15:33:20', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180622/5b2d163b08cd9.jpg'),
(54, 'Admin', '2018-06-22 15:33:21', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/static/img/load.gif'),
(55, 'Admin', '2018-06-22 15:33:22', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180622/5b2d163178169.jpg'),
(56, 'Admin', '2018-06-22 15:33:22', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(57, 'Admin', '2018-06-22 15:34:07', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180622/5b2d163b08cd9.jpg'),
(58, 'Admin', '2018-06-22 15:34:07', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/static/img/load.gif'),
(59, 'Admin', '2018-06-22 15:34:07', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180622/5b2d16eb00060.jpg'),
(60, 'Admin', '2018-06-22 15:34:08', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(61, 'Admin', '2018-06-22 15:35:16', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180622/5b2d163b08cd9.jpg'),
(62, 'Admin', '2018-06-22 15:35:16', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180622/5b2d17336ed35.jpg'),
(63, 'Admin', '2018-06-22 15:35:17', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180622/5b2d163b08cd9.jpg'),
(64, 'Admin', '2018-06-22 15:35:17', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180622/5b2d16eb00060.jpg'),
(65, 'Admin', '2018-06-22 15:35:17', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180622/5b2d17336ed35.jpg'),
(66, 'Admin', '2018-06-22 15:35:17', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(67, 'Admin', '2018-06-22 15:35:17', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180622/5b2d16eb00060.jpg'),
(68, 'Admin', '2018-06-22 15:35:18', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180622/5b2d163b08cd9.jpg'),
(69, 'Admin', '2018-06-22 15:35:19', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(70, 'Admin', '2018-06-22 15:35:19', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180622/5b2d17336ed35.jpg'),
(71, 'Admin', '2018-06-22 15:35:20', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180622/5b2d16eb00060.jpg'),
(72, 'Admin', '2018-06-23 00:26:25', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180623/5b2d93a32f87d.jpg'),
(73, 'Admin', '2018-06-23 00:26:25', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180623/5b2d93a852977.jpg'),
(74, 'Admin', '2018-06-23 00:26:25', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180623/5b2d93ad8054d.jpg'),
(75, 'Admin', '2018-06-23 00:26:25', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(76, 'Admin', '2018-06-23 00:42:25', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180623/5b2d973e41dc3.jpg'),
(77, 'Admin', '2018-06-23 00:42:25', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180623/5b2d976fdc6c7.jpg'),
(78, 'Admin', '2018-06-23 00:42:25', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180623/5b2d93ad8054d.jpg'),
(79, 'Admin', '2018-06-23 00:42:25', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(80, 'Admin', '2018-06-23 00:43:06', '向t_blog添加hrewurfiue rerrewtret 4 <p>sdyursudfudsfffd</p> ryuerfeff 0 0'),
(81, 'Admin', '2018-06-23 00:43:35', '从t_blog修改字段名为id值为97的数据，修改为hrewurfiue  4 <p>sdyursudfudsfffddudfidf</p> ryuerfeff'),
(82, 'Admin', '2018-06-23 00:43:43', '从t_blog删除字段名为id值为97的数据'),
(83, 'Admin', '2018-06-23 00:43:58', '从t_blogger修改字段名为userName值为JLoongKing的数据，修改为<p>老当益壮，宁移白首之心。穷且益坚，不坠青云之志。dfdsaff</p>'),
(84, 'Admin', '2018-06-23 00:44:21', '从t_blogger修改字段名为userName值为JLoongKing的数据，修改为/tp50/public/Uploads/20180623/5b2d97e335b87.jpg'),
(85, 'Admin', '2018-06-23 00:44:38', '从t_blogger修改字段名为userName值为JLoongKing的数据，修改为<p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">白衣裳凭朱栏立</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">凉月趖西</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">点鬓霜微</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">岁晏知君归不归</span><br/><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">残更目断传书雁</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">尺素还稀</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">一味相思</span><br/><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\">准拟相看似旧时</span></p><p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\"><br/></span></p><p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\"><br/></span></p><p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\"></span></p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">《贺新郎·甚矣吾衰矣》</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">【宋】辛弃疾</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">甚矣吾衰矣。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">怅平生、交游零落，只今馀几！</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">白发空垂三千丈，一笑人间万事。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">问何物、能令公喜？</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">我见青山多妩媚，料青山见我应如是。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">情与貌，略相似。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">一尊搔首东窗里。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">想渊明《停云》诗就，此时风味。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">江左沉酣求名者，岂识浊醪妙理。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">回首叫、云飞风起。</p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\"><br/></p><p class=\"section txt\" style=\"box-sizing: border-box; word-break: break-all; word-wrap: break-word; margin-top: 20px; margin-bottom: 0px; padding: 0px; line-height: 28px; font-size: 18px; color: rgb(51, 51, 51); font-family: &quot;Hiragino Sans GB&quot;, &quot;Helvetica Neue&quot;, Helvetica, STHeiTi, &quot;Microsoft Yahei&quot;, sans-serif; text-align: justify; white-space: normal; background-color: rgb(255, 255, 255);\">知我者，二三子。</p><p><span style=\"font-family: sans-serif, console, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, SimSun; font-size: 14px; background-color: rgb(255, 250, 240);\"><br/></span><br/></p>'),
(86, 'Admin', '2018-06-23 00:45:01', '向t_blogtype添加fdfd 2'),
(87, 'Admin', '2018-06-29 04:02:36', '从t_blog删除字段名为id值为96的数据'),
(88, 'Admin', '2018-06-29 04:02:41', '从t_blog删除字段名为id值为95的数据'),
(89, 'Admin', '2018-06-29 04:16:18', '从t_blogtype删除字段名为id值为17的数据'),
(90, 'Admin', '2018-06-29 04:17:23', '从t_blogger修改字段名为userName值为JLoongKing的数据，修改为<p>老当益壮，宁移白首之心。穷且益坚，不坠青云之志。</p>'),
(91, 'Admin', '2018-06-29 04:19:35', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180629/5b35b34bc51b0.jpeg'),
(92, 'Admin', '2018-06-29 04:19:35', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180629/5b35b3511ccbc.jpg'),
(93, 'Admin', '2018-06-29 04:19:35', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180623/5b2d93ad8054d.jpg'),
(94, 'Admin', '2018-06-29 04:19:35', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(95, 'Admin', '2018-06-29 04:20:20', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180629/5b35b381e76fd.jpg'),
(96, 'Admin', '2018-06-29 04:20:20', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180629/5b35b3511ccbc.jpg'),
(97, 'Admin', '2018-06-29 04:20:20', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180623/5b2d93ad8054d.jpg'),
(98, 'Admin', '2018-06-29 04:20:20', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(99, 'Admin', '2018-06-29 04:21:25', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180629/5b35b381e76fd.jpg'),
(100, 'Admin', '2018-06-29 04:21:25', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180629/5b35b3c46ab00.jpg'),
(101, 'Admin', '2018-06-29 04:21:26', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180623/5b2d93ad8054d.jpg'),
(102, 'Admin', '2018-06-29 04:21:26', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(103, 'Admin', '2018-06-29 04:23:50', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180629/5b35b41080e55.png'),
(104, 'Admin', '2018-06-29 04:23:50', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/static/img/load.gif'),
(105, 'Admin', '2018-06-29 04:23:50', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180623/5b2d93ad8054d.jpg'),
(106, 'Admin', '2018-06-29 04:23:50', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(107, 'Admin', '2018-06-29 04:24:21', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180629/5b35b41080e55.png'),
(108, 'Admin', '2018-06-29 04:24:21', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180629/5b35b4654503a.jpg'),
(109, 'Admin', '2018-06-29 04:24:21', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180623/5b2d93ad8054d.jpg'),
(110, 'Admin', '2018-06-29 04:24:21', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180413/5ad02cc644c0f.jpg'),
(111, 'Admin', '2018-07-03 07:56:41', '向t_link添加蒋振飞的博客 www.jzfblog.top 1'),
(112, 'Admin', '2018-07-03 08:37:55', '从t_link删除字段名为id值为9的数据'),
(113, 'Admin', '2018-07-03 08:38:33', '向t_link添加蒋振飞的博客 http://www.jzfblog.top 1'),
(114, 'Admin', '2018-07-04 01:33:45', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180704/5b3c23e33f1a0.jpg'),
(115, 'Admin', '2018-07-04 01:33:45', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180704/5b3c23eb0495c.jpg'),
(116, 'Admin', '2018-07-04 01:33:46', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180704/5b3c23f1712ae.jpg'),
(117, 'Admin', '2018-07-04 01:33:46', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/static/img/load.gif'),
(118, 'Admin', '2018-07-04 01:35:48', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180704/5b3c23e33f1a0.jpg'),
(119, 'Admin', '2018-07-04 01:35:48', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180704/5b3c23eb0495c.jpg'),
(120, 'Admin', '2018-07-04 01:35:48', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180704/5b3c23f1712ae.jpg'),
(121, 'Admin', '2018-07-04 01:35:49', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/static/img/load.gif'),
(122, 'Admin', '2018-07-04 01:36:02', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180704/5b3c23e33f1a0.jpg'),
(123, 'Admin', '2018-07-04 01:36:02', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180704/5b3c23eb0495c.jpg'),
(124, 'Admin', '2018-07-04 01:36:03', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180704/5b3c23f1712ae.jpg'),
(125, 'Admin', '2018-07-04 01:36:03', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/static/img/load.gif'),
(126, 'Admin', '2018-07-04 01:36:31', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180704/5b3c23e33f1a0.jpg'),
(127, 'Admin', '2018-07-04 01:36:31', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180704/5b3c23eb0495c.jpg'),
(128, 'Admin', '2018-07-04 01:36:32', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180704/5b3c23f1712ae.jpg'),
(129, 'Admin', '2018-07-04 01:36:32', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/static/img/load.gif'),
(130, 'Admin', '2018-07-04 01:37:01', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180704/5b3c23e33f1a0.jpg'),
(131, 'Admin', '2018-07-04 01:37:01', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180704/5b3c23eb0495c.jpg'),
(132, 'Admin', '2018-07-04 01:37:02', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180704/5b3c23f1712ae.jpg'),
(133, 'Admin', '2018-07-04 01:37:02', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180704/5b3c24b78b26d.jpg'),
(134, 'Admin', '2018-07-04 01:42:14', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180704/5b3c25bc3f9c9.jpg'),
(135, 'Admin', '2018-07-04 01:42:14', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180704/5b3c25c267cb6.jpg'),
(136, 'Admin', '2018-07-04 01:42:15', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180704/5b3c25c667d71.jpg'),
(137, 'Admin', '2018-07-04 01:42:15', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180704/5b3c25f0d8491.jpg'),
(138, 'Admin', '2018-07-04 01:44:53', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180704/5b3c25bc3f9c9.jpg'),
(139, 'Admin', '2018-07-04 01:44:53', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180704/5b3c25c267cb6.jpg'),
(140, 'Admin', '2018-07-04 01:44:53', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180704/5b3c25c667d71.jpg'),
(141, 'Admin', '2018-07-04 01:44:54', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180704/5b3c2693563ae.jpg'),
(142, 'Admin', '2018-07-04 01:50:35', '从t_banner修改字段名为id值为1的数据，修改为/tp50/public/Uploads/20180704/5b3c25bc3f9c9.jpg'),
(143, 'Admin', '2018-07-04 01:50:35', '从t_banner修改字段名为id值为2的数据，修改为/tp50/public/Uploads/20180704/5b3c25c267cb6.jpg'),
(144, 'Admin', '2018-07-04 01:50:35', '从t_banner修改字段名为id值为3的数据，修改为/tp50/public/Uploads/20180704/5b3c25c667d71.jpg'),
(145, 'Admin', '2018-07-04 01:50:35', '从t_banner修改字段名为id值为4的数据，修改为/tp50/public/Uploads/20180704/5b3c27e8e705e.jpg');

--
-- Indexes for dumped tables
--

--
-- Indexes for table `t_banner`
--
ALTER TABLE `t_banner`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `t_blog`
--
ALTER TABLE `t_blog`
  ADD PRIMARY KEY (`id`),
  ADD KEY `typeId` (`typeId`);

--
-- Indexes for table `t_blogger`
--
ALTER TABLE `t_blogger`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `t_blogtype`
--
ALTER TABLE `t_blogtype`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `t_color`
--
ALTER TABLE `t_color`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `t_comment`
--
ALTER TABLE `t_comment`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `t_link`
--
ALTER TABLE `t_link`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `t_log`
--
ALTER TABLE `t_log`
  ADD PRIMARY KEY (`id`);

--
-- 在导出的表使用AUTO_INCREMENT
--

--
-- 使用表AUTO_INCREMENT `t_banner`
--
ALTER TABLE `t_banner`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'bannerId', AUTO_INCREMENT=5;

--
-- 使用表AUTO_INCREMENT `t_blog`
--
ALTER TABLE `t_blog`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '博客id', AUTO_INCREMENT=98;

--
-- 使用表AUTO_INCREMENT `t_blogger`
--
ALTER TABLE `t_blogger`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '博主id', AUTO_INCREMENT=2;

--
-- 使用表AUTO_INCREMENT `t_blogtype`
--
ALTER TABLE `t_blogtype`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '标签id', AUTO_INCREMENT=18;

--
-- 使用表AUTO_INCREMENT `t_color`
--
ALTER TABLE `t_color`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主题id', AUTO_INCREMENT=3;

--
-- 使用表AUTO_INCREMENT `t_comment`
--
ALTER TABLE `t_comment`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '评论id', AUTO_INCREMENT=19;

--
-- 使用表AUTO_INCREMENT `t_link`
--
ALTER TABLE `t_link`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '链接id', AUTO_INCREMENT=11;

--
-- 使用表AUTO_INCREMENT `t_log`
--
ALTER TABLE `t_log`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '管理员日志id', AUTO_INCREMENT=146;

--
-- 限制导出的表
--

--
-- 限制表 `t_blog`
--
ALTER TABLE `t_blog`
  ADD CONSTRAINT `t_blog_ibfk_1` FOREIGN KEY (`typeId`) REFERENCES `t_blogtype` (`id`);
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
